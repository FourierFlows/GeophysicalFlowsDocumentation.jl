var documenterSearchIndex = {"docs":
[{"location":"modules/multilayerqg/#MultilayerQG-Module-1","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"","category":"section"},{"location":"modules/multilayerqg/#Basic-Equations-1","page":"MultilayerQG Module","title":"Basic Equations","text":"","category":"section"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"This module solves the layered quasi-geostrophic equations on a beta-plane of variable fluid depth H-h(xy). The flow in each layer is obtained through a streamfunction psi_j as (u_j upsilon_j) = (-partial_ypsi_j partial_xpsi_j), j=1n, where n is the number of fluid layers.","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"The QGPV in each layer is","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"mathrmQGPV_j = q_j  + underbracef_0+beta y_textrmplanetary PV + delta_jnunderbracefracf_0 hH_n_textrmtopographic PVquad j=1n","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"where","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"q_1 = nabla^2psi_1 + F_32 1 (psi_2-psi_1)\nq_j = nabla^2psi_j + F_j-12 j (psi_j-1-psi_j) + F_j+12 j (psi_j+1-psi_j)quad j=2dotsn-1\nq_n = nabla^2psi_n + F_n-12 n (psi_n-1-psi_n)","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"with","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"F_j+12 k = fracf_0^2g_j+12 H_kquadtextandquad\ng_j+12 = gfracrho_j+1-rho_jrho_j+1 ","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"Therefore, in Fourier space the q's and psi's are related through","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"beginpmatrix widehatq_boldsymbolk1vdotswidehatq_boldsymbolkn endpmatrix =\nunderbraceleft(-boldsymbolk^2mathbb1 + mathbbF right)_equiv mathbbS_boldsymbolk\nbeginpmatrix widehatpsi_boldsymbolk1vdotswidehatpsi_boldsymbolkn endpmatrix","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"where","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"mathbbF equiv beginpmatrix\n -F_32 1               F_32 1     0     cdots     0\n  F_32 2  -(F_32 2+F_52 2)  F_52 2         vdots\n 0                             ddots     ddots    ddots  \n vdots                                                      0 \n 0                  cdots                0    F_n-12 n  -F_n-12 n\nendpmatrix","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"Including an imposed zonal flow U_j(y) in each layer the equations of motion are:","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"partial_t q_j + mathsfJ(psi_j q_j ) + (U_j - partial_ypsi_j) partial_x Q_j +  U_j partial_x q_j  + (partial_y Q_j)(partial_xpsi_j) = -delta_jnmunabla^2psi_n - nu(-1)^n_nu nabla^2n_nu q_j","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"with","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"partial_y Q_j equiv beta - partial_y^2 U_j - (1-delta_j1)F_j-12 j (U_j-1-U_j) - (1-delta_jn)F_j+12 j (U_j+1-U_j) + delta_jnpartial_yeta \npartial_x Q_j equiv delta_jnpartial_xeta","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"The eddy kinetic energy in each layer is:","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"textrmKE_j = dfracH_jH int dfrac12 boldsymbolnablapsi_j^2 fracmathrmd^2boldsymbolxL_x L_yquad j=1dotsn","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"while the eddy potential energy related to each of fluid interface is","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"textrmPE_j+12 = int dfrac12 dfracf_0^2g_j+12 (psi_j-psi_j+1)^2 fracmathrmd^2boldsymbolxL_x L_yquad j=1dotsn-1","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"The lateral eddy fluxes in each layer are:","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"textrmlateralfluxes_j = dfracH_jH int U_jupsilon_j partial_y u_j fracmathrmd^2boldsymbolxL_x L_yquad j=1dotsn","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"while the vertical fluxes accros fluid interfaces are:","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"textrmverticalfluxes_j+12 = int dfracf_0^2g_j+12 H (U_j-U_j+1)upsilon_j+1psi_j fracmathrmd^2boldsymbolxL_x L_yquad j=1dotsn-1\n","category":"page"},{"location":"modules/multilayerqg/#Implementation-1","page":"MultilayerQG Module","title":"Implementation","text":"","category":"section"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"Matrices mathbbS_boldsymbolk as well as mathbbS^-1_boldsymbolk are included in params as params.S and params.invS respectively.","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"You can get widehatpsi_j from widehatq_j with streamfunctionfrompv!(psih, qh, invS, grid), while to go from widehatpsi_j back to widehatq_j pvfromstreamfunction!(qh, psih, S, grid).","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"The equations are time-stepped forward in Fourier space:","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"partial_t widehatq_j = - widehatmathsfJ(psi_j q_j)  - widehatU_j partial_x Q_j - widehatU_j partial_x q_j\n+ widehat(partial_ypsi_j) partial_x Q_j  - widehat(partial_xpsi_j)(partial_y Q_j) + delta_jnmu k^2 widehatpsi_n - nu k^2n_nu widehatq_j","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"In doing so the Jacobian is computed in the conservative form: mathsfJ(fg) = partial_y  (partial_x f) g -partial_x (partial_y f) g.","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"Thus:","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"mathcalL = - nu k^2n_nu ","category":"page"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"mathcalN(widehatq_j) = - widehatmathsfJ(psi_j q_j) - widehatU_j partial_x Q_j - widehatU_j partial_x q_j\n + widehat(partial_ypsi_j)(partial_x Q_j) - widehat(partial_xpsi_j)(partial_y Q_j) + delta_jnmu k^2 widehatpsi_n ","category":"page"},{"location":"modules/multilayerqg/#Examples-1","page":"MultilayerQG Module","title":"Examples","text":"","category":"section"},{"location":"modules/multilayerqg/#","page":"MultilayerQG Module","title":"MultilayerQG Module","text":"examples/multilayerqg_2layer.jl: A script that simulates baroclinic eddy turbulence growth and equilibration of the Phillips 2-layer model..","category":"page"},{"location":"basics/#Code-Basics-1","page":"Code Basics","title":"Code Basics","text":"","category":"section"},{"location":"basics/#Basic-Notation-1","page":"Code Basics","title":"Basic Notation","text":"","category":"section"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"The code solves partial differential equations of the general form:","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"partial_t u = mathcalLu + mathcalN(u) ","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"(Note: ODEs are special cases of the above. Thus the code also solves ODEs.)","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"We decompose the right hand side of the above in a linear part (mathcalLu) and a nonlinear part (mathcalN(u)). The time steppers treat the linear and nonlinear parts differently.","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"Boundary conditions in all spatial dimensions are periodic. That allows us to expand all variables using a Fourier decomposition. For example, a variable phi(x t) that depends in one spatial dimension is expanded as:","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"phi(x t) = sum_k widehatphi(k t)e^mathrmi k x ","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"where wavenumbers k take the values tfrac2piL_x0pm 1pm 2dots. The equation is time-stepped forward in Fourier space. That way u becomes the array with all Fourier coefficients of the solution.","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"The coefficients for the linear operator mathcalL are stored in an array called LC. The term mathcalN(u) is computed for by calling the function calcN!.","category":"page"},{"location":"basics/#Abstract-SuperTypes-1","page":"Code Basics","title":"Abstract SuperTypes","text":"","category":"section"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"The code is divided along conceptual lines into problem-agnostic and problem-specific components. Files that contain problem-agnostic parts of the code are stored in /src. Files in /src define the domain, 'AbstractTypes' that supertype problem-specific types, and time-stepper types and routines. Problem-specific modules are stored in /src/physics.","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"Below is a list of all Abstract Supertypes used by the code:","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"AbstractGrid: Includes all variables that have to do with the grid, both in physical space as well as in wavenumber space. Currently implemented are: ZeroGrid for ODEs, OneGrid for PDEs with one spatial dimension, and TwoGrid for PDEs with two spatial dimensions. Grids are generic and work for any problem of that particular dimension.\nAbstractParams: Includes all parameters or functions related with the problem do not vary throughout the integration.\nAbstractVars: Includes all variables of the problem that change along the integration.\nAbstractEquation: Includes the array with the coefficients of the linear part of the equation, LC as well as function calcN! that computes the nonlinear part of the equation.\nAbstractState: Includes the solution sol at current time-step as well as the time-step dt, the time t, and step which counts the number of time-steps taken.\nAbstractTimeStepper: Includes all details for the time-stepper (e.g., dt, various coefficients, sol at intermediate time-step values). Time-steppers are generic and work for any problem.\nAbstractProblem: A super-supertype that includes all of the above. That is problem includes grid, vars, params, eqn, ts, state, and also t and step.","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"Grids and time-steppers are generic and work for any problem of that particular dimension. State and Problem just gathers things together. Thus, to write a solver for a new physical problem you only need to prescribe params, vars, the coefficients of the linear part, LC, and function calcN!.","category":"page"},{"location":"basics/#Source-code-organization-1","page":"Code Basics","title":"Source code organization","text":"","category":"section"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"The code is divided along conceptual lines into problem-agnostic and problem-specific components. Files that contain problem-agnostic parts of the code are stored in /src. Files in /src define the domain, 'AbstractTypes' that supertype problem-specific types, and time-stepper types and routines. Problem-specific modules are stores in /src/physics.","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"Here's an overview of the code structure:","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"/src/\nFourierFlows.jl\nDefines supertyping AbstractParams, AbstractGrid, etc.\nDefines a Problem type to organize the grid, vars, params, equation, and timestepper into a single structure.\nIncludes all sources files and physics files.\ntimesteppers.jl: defines modules and stepforward! routines for   various time-steppers. Current implemented time-steppers are:\nForward Euler\n3rd-order Adams-Bashforth (AB3)\n4th-order Runge-Kutta (RK4)\n4th-order Runge-Kutta Exponential Time Differencing (ETDRK4)\n4th-order Dual Runge-Kutta (DualRK4)\n4th-order Dual Runge-Kutta Exponential Time Differencing (DualETDRK4)\nFor each time-stepper exists also a \"filtered\" version that filters out high-wavenumber spectral components of the solution. The Dual time-steppers evolve a state variable that comprises both of real valued         and complex valued fields.\nphysics/\ntwodnavierstokes.jl: Defines a TwoDNavierStokes module that provides a solver for the two-dimensional vorticity equation.\nbarotropicqg.jl: Defines a BarotropicQG module that provides several solvers for the barotropic QG model that permit beta, topography, beta + topography, and forcing.\nkuramotosivashinsky.jl: Defines a KuramotoSivashinsky module that solves the Kuramoto-Sivashinsky.\nverticallyfourierboussinesq.jl: Defines a VerticallyFourierBoussinesq module that solves the two-mode truncation of the Fourier series thin-layer approximation to the hydrostatic Boussinesq equations.\nverticallycosinerboussinesq.jl: Defines a VerticallyCosineBoussinesq module that solves the two-mode truncation of the Sin/Cos series thin-layer approximation to the hydrostatic Boussinesq equations.\ntraceradvdiff.jl: Defines a TracerAdvDiff module that provides a solver for a two-dimensional and periodic tracer field in a given 2D flow (u, w), which can be an arbitrary function of x, z, and t.","category":"page"},{"location":"basics/#Basic-steps-for-solving-a-problem:-step-through-an-example-script-1","page":"Code Basics","title":"Basic steps for solving a problem: step through an example script","text":"","category":"section"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"To illustrate the basic steps for solving a problem consider the 1D Kuramoto-Sivashinsky equation for u(x t):","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"partial_t u + partial_x^4 u + partial_x^2 u + upartial_x u = 0 ","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"which in Fourier base reads:","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"partial_t widehatu = underbrace(- k_x^4 + k_x^2) widehatu_mathcalLwidehatu\n+ underbracewidehat -upartial_x u _mathcalN(widehatu) ","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"The steps to construct an AbstractProblem for the above are:","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"Construct an AbstractGrid; for this problem we use the OneGrid.\nConstruct an AbstractParams; for this problem params is be empty as there are no parameters in the equation. (Note that e.g., the domain size Lx and the number of gridpoints nx belong to the grid.)\nConstruct an AbstractVars; for this problem vars includes u, partial_x u, upartial_x u and their Fourier transforms widehatu, widehatpartial_x u, widehatupartial_xu.\nConstruct the equations by prescribing coefficients for the linear part as an array LC and a function calcN! that computes mathcalN(widehatu).\nConstruct the time-stepper which includes function stepforward! that time-steps the solution.\nConstruct the state and gather everything as an AbstractProblem.","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"The example script found in  examples/kuramotosivashinsky/trefethenexample.jl demonstrates the above steps needed to construct an AbstractProblem. The prob is constructed by calling prob = InitialValueProblem(nx=nx, Lx=Lx, dt=dt, stepper=\"ETDRK4\"). Looking into the  InitialValueProblem function we can see the above steps:","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"function InitialValueProblem(;\n     nx = 256,\n     Lx = 2π,\n     dt = 0.01,\nstepper = \"RK4\"\n)\n\ng  = OneDGrid(nx, Lx)\npr = Params()\nvs = Vars(g)\neq = Equation(pr, g)\nts = FourierFlows.autoconstructtimestepper(stepper, dt, eq.LC, g)\n\nFourierFlows.Problem(g, vs, pr, eq, ts)\nend","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"The OneDGrid function is called for the grid. Within grid the wavenumber array is constructed:","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"i1 = 0:Int(nx/2)\ni2 = Int(-nx/2+1):-1\nk = Array{T}(2π/Lx*cat(1, i1, i2))\nkr = Array{T}(2π/Lx*cat(1, i1))","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"For real-valued fields we use rfft and thus only positive wavenumbers are involved: array kr. E.g., for nx=8 and Lx=2π the wavenumber grids are: k = [0, 1, 2, 3, 4, -3, -2, -1] and kr = [0, 1, 2, 3, 4].","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"The construction of the grids only works for even number of grid points. Moreover, since the code relies on the mathrmFFT algorithm, we suggest you use a power of 2 as the number of grid points, since then mathrmFFT is most efficient. ","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"Function Vars(g) initialize variables u, ux, and uux as real valued arrays of length nx and variables uh, uxh, and uuxh as complex valued arrays of length nkr = Int(nx/2+1) (the same length as kr). As a general convention variable names with h denote the Fourier transforms of the corresponding variable (h stands for 'hat').","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"The array LC is constructed by Equation function","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"function Equation(p, g)\n  LC = @. g.kr^2 - g.kr^4\n  FourierFlows.Equation(LC, calcN!)\nend","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"Also eq includes function calcN! which computes the nonlinear term mathcalN(widehatu):","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"function calcN!(N, sol, t, s, v, p, g)\n  @. v.uh = sol\n  @. v.uxh = im*g.kr*sol\n  A_mul_B!(v.u, g.irfftplan, v.uh)\n  A_mul_B!(v.ux, g.irfftplan, v.uxh)\n  @. v.uux = v.u*v.ux\n  A_mul_B!(v.uuxh, g.rfftplan, v.uux)\n  @. N = -v.uuxh\n  dealias!(N, g)\n  nothing\nend","category":"page"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"The time-stepper is constructed and stored as ts. Finally, all supertypes are gathered together as an AbstractProblem.","category":"page"},{"location":"basics/#Tutorials-1","page":"Code Basics","title":"Tutorials","text":"","category":"section"},{"location":"basics/#","page":"Code Basics","title":"Code Basics","text":"Pages = [\n    \"modules/twodnavierstokes.md\",\n    \"modules/barotropicqg.md\",\n    \"modules/multilayerqg.md\",\n    \"modules/barotropicqgql.md\"\n        ]\nDepth = 1","category":"page"},{"location":"man/functions/#Functions-1","page":"Functions","title":"Functions","text":"","category":"section"},{"location":"man/functions/#Functions-exported-from-GeophysicalFlows:-1","page":"Functions","title":"Functions exported from GeophysicalFlows:","text":"","category":"section"},{"location":"man/functions/#","page":"Functions","title":"Functions","text":"Modules = [GeophysicalFlows]\nPrivate = false\nOrder = [:function]","category":"page"},{"location":"man/functions/#Functions-exported-from-TwoDNavierStokes:-1","page":"Functions","title":"Functions exported from TwoDNavierStokes:","text":"","category":"section"},{"location":"man/functions/#","page":"Functions","title":"Functions","text":"Modules = [GeophysicalFlows.TwoDNavierStokes]\nPrivate = false\nOrder = [:function]","category":"page"},{"location":"man/functions/#GeophysicalFlows.TwoDNavierStokes.Problem-Tuple{}","page":"Functions","title":"GeophysicalFlows.TwoDNavierStokes.Problem","text":"Problem(; parameters...)\n\nConstruct a 2D turbulence problem.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.TwoDNavierStokes.dissipation-Tuple{Any}","page":"Functions","title":"GeophysicalFlows.TwoDNavierStokes.dissipation","text":"dissipation(prob)\n\nReturns the domain-averaged dissipation rate. nν must be >= 1.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.TwoDNavierStokes.drag-Tuple{Any}","page":"Functions","title":"GeophysicalFlows.TwoDNavierStokes.drag","text":"drag(prob)\n\nReturns the extraction of domain-averaged energy by drag/hypodrag μ.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.TwoDNavierStokes.energy-Tuple{Any}","page":"Functions","title":"GeophysicalFlows.TwoDNavierStokes.energy","text":"energy(prob)\n\nReturns the domain-averaged kinetic energy in the Fourier-transformed vorticity solution sol.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.TwoDNavierStokes.enstrophy-Tuple{Any}","page":"Functions","title":"GeophysicalFlows.TwoDNavierStokes.enstrophy","text":"enstrophy(prob)\n\nReturns the domain-averaged enstrophy in the Fourier-transformed vorticity solution sol.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.TwoDNavierStokes.set_zeta!-Tuple{Any,Any}","page":"Functions","title":"GeophysicalFlows.TwoDNavierStokes.set_zeta!","text":"set_zeta!(prob, zeta)\n\nSet the solution sol as the transform of zeta and update variables v on the grid g.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.TwoDNavierStokes.updatevars!-Tuple{Any}","page":"Functions","title":"GeophysicalFlows.TwoDNavierStokes.updatevars!","text":"updatevars!(prob)\n\nUpdate the vars in v on the grid g with the solution in sol.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.TwoDNavierStokes.work-Tuple{Any,GeophysicalFlows.TwoDNavierStokes.Vars{#s28,#s27,#s26,Nothing} where #s26<:AbstractArray where #s27<:AbstractArray where #s28<:AbstractArray,Any}","page":"Functions","title":"GeophysicalFlows.TwoDNavierStokes.work","text":"work(prob)\nwork(sol, v, g)\n\nReturns the domain-averaged rate of work of energy by the forcing Fh.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#Functions-exported-from-BarotropicQG:-1","page":"Functions","title":"Functions exported from BarotropicQG:","text":"","category":"section"},{"location":"man/functions/#","page":"Functions","title":"Functions","text":"Modules = [GeophysicalFlows.BarotropicQG]\nPrivate = false\nOrder = [:function]","category":"page"},{"location":"man/functions/#GeophysicalFlows.BarotropicQG.dissipation-NTuple{4,Any}","page":"Functions","title":"GeophysicalFlows.BarotropicQG.dissipation","text":"dissipation(prob)\ndissipation(s, v, p, g)\n\nReturns the domain-averaged dissipation rate. nν must be >= 1.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.BarotropicQG.drag-Tuple{Any}","page":"Functions","title":"GeophysicalFlows.BarotropicQG.drag","text":"drag(prob)\ndrag(s, v, p, g)\n\nReturns the extraction of domain-averaged energy by drag μ.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.BarotropicQG.energy-Tuple{Any,AbstractGrid}","page":"Functions","title":"GeophysicalFlows.BarotropicQG.energy","text":"energy(sol, g)\nenergy(prob)\n\nReturns the domain-averaged kinetic energy of sol.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.BarotropicQG.enstrophy-Tuple{Any,AbstractGrid,AbstractVars}","page":"Functions","title":"GeophysicalFlows.BarotropicQG.enstrophy","text":"enstrophy(sol, g, v)\nenstrophy(prob)\n\nReturns the domain-averaged enstrophy of sol.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.BarotropicQG.meanenergy-Tuple{Any}","page":"Functions","title":"GeophysicalFlows.BarotropicQG.meanenergy","text":"meanenergy(prob)\n\nReturns the energy of the domain-averaged U.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.BarotropicQG.meanenstrophy-Tuple{Any}","page":"Functions","title":"GeophysicalFlows.BarotropicQG.meanenstrophy","text":"meanenstrophy(prob)\n\nReturns the enstrophy of the domain-averaged U.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.BarotropicQG.set_zeta!-Tuple{Any,GeophysicalFlows.BarotropicQG.Vars,Any,Any,Any}","page":"Functions","title":"GeophysicalFlows.BarotropicQG.set_zeta!","text":"set_zeta!(prob, zeta)\nset_zeta!(s, v, g, zeta)\n\nSet the solution sol as the transform of zeta and update variables v on the grid g.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.BarotropicQG.updatevars!-NTuple{4,Any}","page":"Functions","title":"GeophysicalFlows.BarotropicQG.updatevars!","text":"updatevars!(v, s, g)\n\nUpdate the vars in v on the grid g with the solution in sol.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.BarotropicQG.work-Tuple{Any,GeophysicalFlows.BarotropicQG.Vars{#s35,#s34,#s33,#s32,Nothing} where #s32<:AbstractArray where #s33<:AbstractArray where #s34<:AbstractArray where #s35<:AbstractArray,Any}","page":"Functions","title":"GeophysicalFlows.BarotropicQG.work","text":"work(prob)\nwork(s, v, p, g)\n\nReturns the domain-averaged rate of work of energy by the forcing Fqh.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#Functions-exported-from-BarotropicQGQL:-1","page":"Functions","title":"Functions exported from BarotropicQGQL:","text":"","category":"section"},{"location":"man/functions/#","page":"Functions","title":"Functions","text":"Modules = [GeophysicalFlows.BarotropicQGQL]\nPrivate = false\nOrder = [:function]","category":"page"},{"location":"man/functions/#GeophysicalFlows.BarotropicQGQL.Problem-Tuple{}","page":"Functions","title":"GeophysicalFlows.BarotropicQGQL.Problem","text":"Problem(; parameters...)\n\nConstruct a BarotropicQGQL turbulence problem.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.BarotropicQGQL.dissipation-NTuple{4,Any}","page":"Functions","title":"GeophysicalFlows.BarotropicQGQL.dissipation","text":"dissipation(prob)\ndissipation(sol, v, p, g)\n\nReturns the domain-averaged dissipation rate. nnu must be >= 1.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.BarotropicQGQL.drag-Tuple{Any}","page":"Functions","title":"GeophysicalFlows.BarotropicQGQL.drag","text":"drag(prob)\ndrag(sol, v, p, g)\n\nReturns the extraction of domain-averaged energy by drag mu.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.BarotropicQGQL.energy-Tuple{Any,AbstractGrid}","page":"Functions","title":"GeophysicalFlows.BarotropicQGQL.energy","text":"energy(sol, g)\nenergy(prob)\n\nReturns the domain-averaged kinetic energy of sol.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.BarotropicQGQL.enstrophy-Tuple{Any,AbstractGrid,AbstractVars}","page":"Functions","title":"GeophysicalFlows.BarotropicQGQL.enstrophy","text":"enstrophy(sol, g, v)\nenstrophy(prob)\n\nReturns the domain-averaged enstrophy of sol.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.BarotropicQGQL.set_zeta!-NTuple{5,Any}","page":"Functions","title":"GeophysicalFlows.BarotropicQGQL.set_zeta!","text":"set_zeta!(prob, zeta)\nset_zeta!(sol, v, g, zeta)\n\nSet the solution sol as the transform of zeta and update variables v on the grid g.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.BarotropicQGQL.updatevars!-NTuple{4,Any}","page":"Functions","title":"GeophysicalFlows.BarotropicQGQL.updatevars!","text":"updatevars!(v, s, g)\n\nUpdate the vars in v on the grid g with the solution in sol.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.BarotropicQGQL.work-Tuple{Any,GeophysicalFlows.BarotropicQGQL.ForcedVars,Any}","page":"Functions","title":"GeophysicalFlows.BarotropicQGQL.work","text":"work(prob)\nwork(sol, v, p, g)\n\nReturns the domain-averaged rate of work of energy by the forcing Fh.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#Functions-exported-from-MultilayerQG:-1","page":"Functions","title":"Functions exported from MultilayerQG:","text":"","category":"section"},{"location":"man/functions/#","page":"Functions","title":"Functions","text":"Modules = [GeophysicalFlows.MultilayerQG]\nPrivate = false\nOrder = [:function]","category":"page"},{"location":"man/functions/#GeophysicalFlows.MultilayerQG.energies-Tuple{Any}","page":"Functions","title":"GeophysicalFlows.MultilayerQG.energies","text":"energies(prob)\n\nReturns the kinetic energy of each fluid layer KE1,...,KEnlayers, and the potential energy of each fluid interface PE{3/2},...,PE{nlayers-1/2}.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.MultilayerQG.fluxes-Tuple{Any}","page":"Functions","title":"GeophysicalFlows.MultilayerQG.fluxes","text":"fluxes(prob)\n\nReturns the lateral eddy fluxes within each fluid layer lateralfluxes1,...,lateralfluxesnlayers and also the vertical eddy fluxes for each fluid interface verticalfluxes{3/2},...,verticalfluxes{nlayers-1/2}\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.MultilayerQG.set_psi!-Tuple{Any,Any}","page":"Functions","title":"GeophysicalFlows.MultilayerQG.set_psi!","text":"set_psi!(prob)\n\nSet the solution prob.sol to correspond to a streamfunction psi and updates variables.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.MultilayerQG.set_q!-Tuple{Any,Any}","page":"Functions","title":"GeophysicalFlows.MultilayerQG.set_q!","text":"set_q!(prob)\n\nSet the solution prob.sol as the transform of q and updates variables.\n\n\n\n\n\n","category":"method"},{"location":"man/functions/#GeophysicalFlows.MultilayerQG.updatevars!-Tuple{Any}","page":"Functions","title":"GeophysicalFlows.MultilayerQG.updatevars!","text":"updatevars!(prob)\n\nUpdate prob.vars using prob.sol.\n\n\n\n\n\n","category":"method"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"EditURL = \"https://github.com/FourierFlows/GeophysicalFlows.jl/blob/master/examples/barotropicqg_betaforced.jl\"","category":"page"},{"location":"generated/barotropicqg_betaforced/#Forced-dissipative-barotropic-QG-beta-plane-turbulence-1","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"","category":"section"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"This example can be run online via (Image: ). Also, it can be viewed as a Jupyter notebook via (Image: ).","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"A simulation of forced-dissipative barotropic quasi-geostrophic turbulence on a beta plane. The dynamics include linear drag and stochastic excitation.","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"using FourierFlows, Plots, Statistics, Printf, Random\n\nusing FourierFlows: parsevalsum\nusing FFTW: irfft\nusing Statistics: mean\nusing Random: seed!\n\nimport GeophysicalFlows.BarotropicQG\nimport GeophysicalFlows.BarotropicQG: energy, enstrophy","category":"page"},{"location":"generated/barotropicqg_betaforced/#Choosing-a-device:-CPU-or-GPU-1","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Choosing a device: CPU or GPU","text":"","category":"section"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"dev = CPU()    # Device (CPU/GPU)\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betaforced/#Numerical-parameters-and-time-stepping-parameters-1","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Numerical parameters and time-stepping parameters","text":"","category":"section"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"     nx = 128            # 2D resolution = nx^2\nstepper = \"FilteredRK4\"  # timestepper\n     dt = 0.05           # timestep\n nsteps = 8000           # total number of time-steps\n nsubs  = 10             # number of time-steps for intermediate logging/plotting (nsteps must be multiple of nsubs)\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betaforced/#Physical-parameters-1","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Physical parameters","text":"","category":"section"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"Lx = 2π        # domain size\n β = 10.0      # planetary PV gradient\n μ = 0.01      # bottom drag\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betaforced/#Forcing-1","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forcing","text":"","category":"section"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"We force the vorticity equation with stochastic excitation that is delta-correlated in time and while spatially homogeneously and isotropically correlated. The forcing has a spectrum with power in a ring in wavenumber space of radious k_f and width delta k_f, and it injects energy per unit area and per unit time equal to varepsilon.","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"forcing_wavenumber = 14.0    # the central forcing wavenumber for a spectrum that is a ring in wavenumber space\nforcing_bandwidth  = 1.5     # the width of the forcing spectrum\nε = 0.001                    # energy input rate by the forcing\n\ngr  = TwoDGrid(nx, Lx)\n\nk = [ gr.kr[i] for i=1:gr.nkr, j=1:gr.nl] # a 2D grid with the zonal wavenumber\n\nforcing_spectrum = @. exp( -(sqrt(gr.Krsq)-forcing_wavenumber)^2 / (2forcing_bandwidth^2) )\n@. forcing_spectrum[ gr.Krsq < (2π/Lx*2)^2  ] = 0\n@. forcing_spectrum[ gr.Krsq > (2π/Lx*20)^2 ] = 0\n@. forcing_spectrum[ k .< 2π/Lx ] .= 0 # make sure forcing does not have power at k=0 component\nε0 = parsevalsum(forcing_spectrum .* gr.invKrsq/2, gr)/(gr.Lx*gr.Ly)\n@. forcing_spectrum = ε/ε0 * forcing_spectrum  # normalization so that forcing injects energy ε per domain area per unit time\n\nseed!(1234) # reset of the random number generator for reproducibility\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"Next we construct function calcF! that computes a forcing realization every timestep","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"function calcFq!(Fh, sol, t, clock, vars, params, grid)\n  ξ = ArrayType(dev)(exp.(2π*im*rand(eltype(grid), size(sol)))/sqrt(clock.dt))\n  @. Fh = ξ*sqrt.(forcing_spectrum)\n  Fh[abs.(grid.Krsq).==0] .= 0\n  nothing\nend\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betaforced/#Problem-setup-1","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Problem setup","text":"","category":"section"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"We initialize a Problem by providing a set of keyword arguments. Not providing a viscosity coefficient ν leads to the module's default value: ν=0. In this example numerical instability due to accumulation of enstrophy in high wavenumbers is taken care with the FilteredTimestepper we picked.","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"prob = BarotropicQG.Problem(nx=nx, Lx=Lx, β=β, μ=μ, dt=dt, stepper=stepper,\n                            calcFq=calcFq!, stochastic=true, dev=dev)\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"Let's define some shortcuts.","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"sol, cl, vs, pr, gr = prob.sol, prob.clock, prob.vars, prob.params, prob.grid\nx, y = gr.x, gr.y\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"First let's see how a forcing realization looks like.","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"calcFq!(vs.Fqh, sol, 0.0, cl, vs, pr, gr)\n\nheatmap(x, y, irfft(vs.Fqh, gr.nx),\n     aspectratio = 1,\n               c = :balance,\n            clim = (-8, 8),\n           xlims = (-gr.Lx/2, gr.Lx/2),\n           ylims = (-gr.Ly/2, gr.Ly/2),\n          xticks = -3:3,\n          yticks = -3:3,\n          xlabel = \"x\",\n          ylabel = \"y\",\n           title = \"a forcing realization\",\n      framestyle = :box)","category":"page"},{"location":"generated/barotropicqg_betaforced/#Setting-initial-conditions-1","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Setting initial conditions","text":"","category":"section"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"Our initial condition is simply fluid at rest.","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"BarotropicQG.set_zeta!(prob, zeros(gr.nx, gr.ny))","category":"page"},{"location":"generated/barotropicqg_betaforced/#Diagnostics-1","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Diagnostics","text":"","category":"section"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"Create Diagnostic – energy and enstrophy are functions imported at the top.","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"E = Diagnostic(energy, prob; nsteps=nsteps)\nZ = Diagnostic(enstrophy, prob; nsteps=nsteps)\ndiags = [E, Z] # A list of Diagnostics types passed to \"stepforward!\" will  be updated every timestep.\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betaforced/#Output-1","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Output","text":"","category":"section"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"We choose folder for outputing .jld2 files and snapshots (.png files).","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"filepath = \".\"\nplotpath = \"./plots_forcedbetaturb\"\nplotname = \"snapshots\"\nfilename = joinpath(filepath, \"forcedbetaturb.jld2\")\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"Do some basic file management,","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"if isfile(filename); rm(filename); end\nif !isdir(plotpath); mkdir(plotpath); end\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"and then create Output.","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"get_sol(prob) = sol # extracts the Fourier-transformed solution\nget_u(prob) = irfft(im*gr.l.*gr.invKrsq.*sol, gr.nx)\nout = Output(prob, filename, (:sol, get_sol), (:u, get_u))\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betaforced/#Visualizing-the-simulation-1","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Visualizing the simulation","text":"","category":"section"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"We define a function that plots the vorticity and streamfunction fields, their corresponding zonal mean structure and timeseries of energy and enstrophy.","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"function plot_output(prob)\n  ζ = prob.vars.zeta\n  ψ = prob.vars.psi\n  ζ̄ = mean(ζ, dims=1)'\n  ū = mean(prob.vars.u, dims=1)'\n\n  pζ = heatmap(x, y, ζ,\n       aspectratio = 1,\n            legend = false,\n                 c = :balance,\n              clim = (-8, 8),\n             xlims = (-gr.Lx/2, gr.Lx/2),\n             ylims = (-gr.Ly/2, gr.Ly/2),\n            xticks = -3:3,\n            yticks = -3:3,\n            xlabel = \"x\",\n            ylabel = \"y\",\n             title = \"vorticity ζ=∂v/∂x-∂u/∂y\",\n        framestyle = :box)\n\n  pψ = contourf(x, y, ψ,\n            levels = -0.32:0.04:0.32,\n       aspectratio = 1,\n         linewidth = 1,\n            legend = false,\n              clim = (-0.22, 0.22),\n                 c = :viridis,\n             xlims = (-gr.Lx/2, gr.Lx/2),\n             ylims = (-gr.Ly/2, gr.Ly/2),\n            xticks = -3:3,\n            yticks = -3:3,\n            xlabel = \"x\",\n            ylabel = \"y\",\n             title = \"streamfunction ψ\",\n        framestyle = :box)\n\n  pζm = plot(ζ̄, y,\n            legend = false,\n         linewidth = 2,\n             alpha = 0.7,\n            yticks = -3:3,\n             xlims = (-3, 3),\n            xlabel = \"zonal mean ζ\",\n            ylabel = \"y\")\n  plot!(pζm, 0*y, y, linestyle=:dash, linecolor=:black)\n\n  pum = plot(ū, y,\n            legend = false,\n         linewidth = 2,\n             alpha = 0.7,\n            yticks = -3:3,\n             xlims = (-0.5, 0.5),\n            xlabel = \"zonal mean u\",\n            ylabel = \"y\")\n  plot!(pum, 0*y, y, linestyle=:dash, linecolor=:black)\n\n  pE = plot(1,\n             label = \"energy\",\n         linewidth = 2,\n             alpha = 0.7,\n             xlims = (-0.1, 4.1),\n             ylims = (0, 0.05),\n            xlabel = \"μt\")\n\n  pZ = plot(1,\n             label = \"enstrophy\",\n         linecolor = :red,\n            legend = :bottomright,\n         linewidth = 2,\n             alpha = 0.7,\n             xlims = (-0.1, 4.1),\n             ylims = (0, 2.5),\n            xlabel = \"μt\")\n\n  l = @layout grid(2, 3)\n  p = plot(pζ, pζm, pE, pψ, pum, pZ, layout=l, size = (1000, 600), dpi=150)\n\n  return p\nend\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betaforced/#Time-stepping-the-Problem-forward-1","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Time-stepping the Problem forward","text":"","category":"section"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"We time-step the Problem forward in time.","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"startwalltime = time()\n\np = plot_output(prob)\n\nanim = @animate for j=0:Int(nsteps/nsubs)\n\n  cfl = cl.dt*maximum([maximum(vs.u)/gr.dx, maximum(vs.v)/gr.dy])\n\n  log = @sprintf(\"step: %04d, t: %d, cfl: %.2f, E: %.4f, Q: %.4f, walltime: %.2f min\",\n  cl.step, cl.t, cfl, E.data[E.i], Z.data[Z.i],\n  (time()-startwalltime)/60)\n\n  if j%(1000/nsubs)==0; println(log) end\n\n  p[1][1][:z] = Array(vs.zeta)\n  p[1][:title] = \"vorticity, μt=\"*@sprintf(\"%.2f\", μ*cl.t)\n  p[4][1][:z] = Array(vs.psi)\n  p[2][1][:x] = mean(vs.zeta, dims=1)'\n  p[5][1][:x] = mean(vs.u, dims=1)'\n  push!(p[3][1], μ*E.t[E.i], E.data[E.i])\n  push!(p[6][1], μ*Z.t[Z.i], Z.data[Z.i])\n\n  stepforward!(prob, diags, nsubs)\n  BarotropicQG.updatevars!(prob)\n\nend\n\nmp4(anim, \"barotropicqg_betaforced.mp4\", fps=18)","category":"page"},{"location":"generated/barotropicqg_betaforced/#Save-1","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Save","text":"","category":"section"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"Finally save the last snapshot.","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"savename = @sprintf(\"%s_%09d.png\", joinpath(plotpath, plotname), cl.step)\nsavefig(savename)","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"","category":"page"},{"location":"generated/barotropicqg_betaforced/#","page":"Forced-dissipative barotropic QG beta-plane turbulence","title":"Forced-dissipative barotropic QG beta-plane turbulence","text":"This page was generated using Literate.jl.","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"EditURL = \"https://github.com/FourierFlows/GeophysicalFlows.jl/blob/master/examples/barotropicqg_betadecay.jl\"","category":"page"},{"location":"generated/barotropicqg_betadecay/#Decaying-barotropic-QG-beta-plane-turbulence-1","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"","category":"section"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"This example can be run online via (Image: ). Also, it can be viewed as a Jupyter notebook via (Image: ).","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"An example of decaying barotropic quasi-geostrophic turbulence on a beta plane.","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"using FourierFlows, Plots, Printf, Random\n\nusing Statistics: mean\nusing FFTW: irfft\n\nimport GeophysicalFlows.BarotropicQG\nimport GeophysicalFlows.BarotropicQG: energy, enstrophy","category":"page"},{"location":"generated/barotropicqg_betadecay/#Choosing-a-device:-CPU-or-GPU-1","page":"Decaying barotropic QG beta-plane turbulence","title":"Choosing a device: CPU or GPU","text":"","category":"section"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"dev = CPU()     # Device (CPU/GPU)\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betadecay/#Numerical-parameters-and-time-stepping-parameters-1","page":"Decaying barotropic QG beta-plane turbulence","title":"Numerical parameters and time-stepping parameters","text":"","category":"section"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"     nx = 128            # 2D resolution = nx^2\nstepper = \"FilteredRK4\"  # timestepper\n     dt = 0.05           # timestep\n nsteps = 2000           # total number of time-steps\n nsubs  = 10             # number of time-steps for intermediate logging/plotting (nsteps must be multiple of nsubs)\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betadecay/#Physical-parameters-1","page":"Decaying barotropic QG beta-plane turbulence","title":"Physical parameters","text":"","category":"section"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"Lx = 2π        # domain size\n β = 10.0      # planetary PV gradient\n μ = 0.0       # bottom drag\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betadecay/#Problem-setup-1","page":"Decaying barotropic QG beta-plane turbulence","title":"Problem setup","text":"","category":"section"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"We initialize a Problem by providing a set of keyword arguments. Not providing a viscosity coefficient ν leads to the module's default value: ν=0. In this example numerical instability due to accumulation of enstrophy in high wavenumbers is taken care with the FilteredTimestepper we picked.","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"prob = BarotropicQG.Problem(nx=nx, Lx=Lx, β=β, μ=μ, dt=dt, stepper=stepper, dev=dev)\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"and define some shortcuts","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"sol, cl, vs, pr, gr = prob.sol, prob.clock, prob.vars, prob.params, prob.grid\nx, y = gr.x, gr.y\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betadecay/#Setting-initial-conditions-1","page":"Decaying barotropic QG beta-plane turbulence","title":"Setting initial conditions","text":"","category":"section"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"Our initial condition consist of a flow that has power only at wavenumbers with 8fracL2pisqrtk_x^2+k_y^210 and initial energy E_0:","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"E0 = 0.1 # energy of initial condition\n\nk = [ gr.kr[i] for i=1:gr.nkr, j=1:gr.nl] # a 2D grid with the zonal wavenumber\n\nRandom.seed!(1234)\nqih = randn(Complex{eltype(gr)}, size(sol))\nqih[ gr.Krsq .< (8*2π /gr.Lx)^2 ] .= 0\nqih[ gr.Krsq .> (10*2π/gr.Lx)^2 ] .= 0\nqih[ k .== 0 ] .= 0 # remove any power from k=0 component\nEin = energy(qih, gr)  # compute energy of qi\nqih = qih*sqrt(E0/Ein) # normalize qi to have energy E0\nqi  = irfft(qih, gr.nx)\n\nBarotropicQG.set_zeta!(prob, qi)\nnothing #hide","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"Let's plot the initial vorticity field:","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"p1 = heatmap(x, y, vs.q,\n         aspectratio = 1,\n              c = :balance,\n           clim = (-12, 12),\n          xlims = (-gr.Lx/2, gr.Lx/2),\n          ylims = (-gr.Ly/2, gr.Ly/2),\n         xticks = -3:3,\n         yticks = -3:3,\n         xlabel = \"x\",\n         ylabel = \"y\",\n          title = \"initial vorticity ζ=∂v/∂x-∂u/∂y\",\n     framestyle = :box)\n\np2 = contourf(x, y, vs.psi,\n        aspectratio = 1,\n             c = :viridis,\n        levels = range(-0.65, stop=0.65, length=10),\n          clim = (-0.65, 0.65),\n         xlims = (-gr.Lx/2, gr.Lx/2),\n         ylims = (-gr.Ly/2, gr.Ly/2),\n        xticks = -3:3,\n        yticks = -3:3,\n        xlabel = \"x\",\n        ylabel = \"y\",\n         title = \"initial streamfunction ψ\",\n    framestyle = :box)\n\nl = @layout grid(1, 2)\np = plot(p1, p2, layout=l, size=(900, 400))","category":"page"},{"location":"generated/barotropicqg_betadecay/#Diagnostics-1","page":"Decaying barotropic QG beta-plane turbulence","title":"Diagnostics","text":"","category":"section"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"Create Diagnostics – energy and enstrophy functions are imported at the top.","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"E = Diagnostic(energy, prob; nsteps=nsteps)\nZ = Diagnostic(enstrophy, prob; nsteps=nsteps)\ndiags = [E, Z] # A list of Diagnostics types passed to \"stepforward!\" will  be updated every timestep.\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betadecay/#Output-1","page":"Decaying barotropic QG beta-plane turbulence","title":"Output","text":"","category":"section"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"We choose folder for outputing .jld2 files and snapshots (.png files).","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"filepath = \".\"\nplotpath = \"./plots_decayingbetaturb\"\nplotname = \"snapshots\"\nfilename = joinpath(filepath, \"decayingbetaturb.jld2\")\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"Do some basic file management,","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"if isfile(filename); rm(filename); end\nif !isdir(plotpath); mkdir(plotpath); end\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"and then create Output.","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"get_sol(prob) = sol # extracts the Fourier-transformed solution\nget_u(prob) = irfft(im*gr.l.*gr.invKrsq.*sol, gr.nx)\nout = Output(prob, filename, (:sol, get_sol), (:u, get_u))\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betadecay/#Visualizing-the-simulation-1","page":"Decaying barotropic QG beta-plane turbulence","title":"Visualizing the simulation","text":"","category":"section"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"We define a function that plots the vorticity and streamfunction fields and their corresponding zonal mean structure.","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"function plot_output(prob)\n  ζ = prob.vars.zeta\n  ψ = prob.vars.psi\n  ζ̄ = mean(ζ, dims=1)'\n  ū = mean(prob.vars.u, dims=1)'\n\n  pζ = heatmap(x, y, ζ,\n       aspectratio = 1,\n            legend = false,\n                 c = :balance,\n              clim = (-12, 12),\n             xlims = (-gr.Lx/2, gr.Lx/2),\n             ylims = (-gr.Ly/2, gr.Ly/2),\n            xticks = -3:3,\n            yticks = -3:3,\n            xlabel = \"x\",\n            ylabel = \"y\",\n             title = \"vorticity ζ=∂v/∂x-∂u/∂y\",\n        framestyle = :box)\n\n  pψ = contourf(x, y, ψ,\n       aspectratio = 1,\n            legend = false,\n                 c = :viridis,\n            levels = range(-0.65, stop=0.65, length=10),\n              clim = (-0.65, 0.65),\n             xlims = (-gr.Lx/2, gr.Lx/2),\n             ylims = (-gr.Ly/2, gr.Ly/2),\n            xticks = -3:3,\n            yticks = -3:3,\n            xlabel = \"x\",\n            ylabel = \"y\",\n             title = \"streamfunction ψ\",\n        framestyle = :box)\n\n  pζm = plot(ζ̄, y,\n            legend = false,\n         linewidth = 2,\n             alpha = 0.7,\n            yticks = -3:3,\n             xlims = (-2.2, 2.2),\n            xlabel = \"zonal mean ζ\",\n            ylabel = \"y\")\n  plot!(pζm, 0*y, y, linestyle=:dash, linecolor=:black)\n\n  pum = plot(ū, y,\n            legend = false,\n         linewidth = 2,\n             alpha = 0.7,\n            yticks = -3:3,\n             xlims = (-0.55, 0.55),\n            xlabel = \"zonal mean u\",\n            ylabel = \"y\")\n  plot!(pum, 0*y, y, linestyle=:dash, linecolor=:black)\n\n  l = @layout grid(2, 2)\n  p = plot(pζ, pζm, pψ, pum, layout = l, size = (900, 800))\n\n  return p\nend\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_betadecay/#Time-stepping-the-Problem-forward-1","page":"Decaying barotropic QG beta-plane turbulence","title":"Time-stepping the Problem forward","text":"","category":"section"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"We time-step the Problem forward in time.","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"startwalltime = time()\n\np = plot_output(prob)\n\nanim = @animate for j=0:Int(nsteps/nsubs)\n\n  log = @sprintf(\"step: %04d, t: %d, E: %.4f, Q: %.4f, walltime: %.2f min\",\n    cl.step, cl.t, E.data[E.i], Z.data[Z.i], (time()-startwalltime)/60)\n\n  if j%(1000/nsubs)==0; println(log) end\n\n\n  p[1][1][:z] = Array(vs.zeta)\n  p[1][:title] = \"vorticity, t=\"*@sprintf(\"%.2f\", cl.t)\n  p[3][1][:z] = Array(vs.psi)\n  p[2][1][:x] = mean(vs.zeta, dims=1)'\n  p[4][1][:x] = mean(vs.u, dims=1)'\n\n  stepforward!(prob, diags, nsubs)\n  BarotropicQG.updatevars!(prob)\n\nend\n\nmp4(anim, \"barotropicqg_betadecay.mp4\", fps=14)","category":"page"},{"location":"generated/barotropicqg_betadecay/#Save-1","page":"Decaying barotropic QG beta-plane turbulence","title":"Save","text":"","category":"section"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"Finally save the last snapshot.","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"savename = @sprintf(\"%s_%09d.png\", joinpath(plotpath, plotname), cl.step)\nsavefig(savename)","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"","category":"page"},{"location":"generated/barotropicqg_betadecay/#","page":"Decaying barotropic QG beta-plane turbulence","title":"Decaying barotropic QG beta-plane turbulence","text":"This page was generated using Literate.jl.","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"EditURL = \"https://github.com/FourierFlows/GeophysicalFlows.jl/blob/master/examples/barotropicqgql_betaforced.jl\"","category":"page"},{"location":"generated/barotropicqgql_betaforced/#Quasi-Linear-forced-dissipative-barotropic-QG-beta-plane-turbulence-1","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"","category":"section"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"This example can be run online via (Image: ). Also, it can be viewed as a Jupyter notebook via (Image: ).","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"A simulation of forced-dissipative barotropic quasi-geostrophic turbulence on a beta plane under the quasi-linear approximation. The dynamics include linear drag and stochastic excitation.","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"using FourierFlows, Plots, Statistics, Printf, Random\n\nusing FourierFlows: parsevalsum\nusing FFTW: irfft\nusing Random: seed!\nusing Statistics: mean\n\nimport GeophysicalFlows.BarotropicQGQL\nimport GeophysicalFlows.BarotropicQGQL: energy, enstrophy","category":"page"},{"location":"generated/barotropicqgql_betaforced/#Numerical-parameters-and-time-stepping-parameters-1","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Numerical parameters and time-stepping parameters","text":"","category":"section"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"     nx = 128            # 2D resolution = nx^2\nstepper = \"FilteredRK4\"  # timestepper\n     dt = 0.05           # timestep\n nsteps = 8000           # total number of time-steps\n nsubs  = 10             # number of time-steps for intermediate logging/plotting (nsteps must be multiple of nsubs)\nnothing # hide","category":"page"},{"location":"generated/barotropicqgql_betaforced/#Physical-parameters-1","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Physical parameters","text":"","category":"section"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"Lx = 2π        # domain size\n β = 10.0      # planetary PV gradient\n μ = 0.01      # bottom drag\nnothing # hide","category":"page"},{"location":"generated/barotropicqgql_betaforced/#Forcing-1","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Forcing","text":"","category":"section"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"We force the vorticity equation with stochastic excitation that is delta-correlated in time and while spatially homogeneously and isotropically correlated. The forcing has a spectrum with power in a ring in wavenumber space of radious k_f and width delta k_f, and it injects energy per unit area and per unit time equal to varepsilon.","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"forcing_wavenumber = 14.0    # the central forcing wavenumber for a spectrum that is a ring in wavenumber space\nforcing_bandwidth  = 1.5     # the width of the forcing spectrum\nε = 0.001                    # energy input rate by the forcing\n\ngr  = TwoDGrid(nx, Lx)\n\nk = [ gr.kr[i] for i=1:gr.nkr, j=1:gr.nl] # a 2D grid with the zonal wavenumber\n\nforcing_spectrum = @. exp( -(sqrt(gr.Krsq)-forcing_wavenumber)^2 / (2forcing_bandwidth^2) )\n@. forcing_spectrum[ gr.Krsq < (2π/Lx*2)^2  ] = 0\n@. forcing_spectrum[ gr.Krsq > (2π/Lx*20)^2 ] = 0\n@. forcing_spectrum[ k .< 2π/Lx ] .= 0 # make sure forcing does not have power at k=0 component\nε0 = parsevalsum(forcing_spectrum .* gr.invKrsq/2, gr) / (gr.Lx*gr.Ly)\n@. forcing_spectrum = ε/ε0 * forcing_spectrum  # normalization so that forcing injects energy ε per domain area per unit time\n\nseed!(1234) # reset of the random number generator for reproducibility\nnothing # hide","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"Next we construct function calcF! that computes a forcing realization every timestep","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"function calcF!(Fh, sol, t, clock, vars, params, grid)\n  ξ = exp.(2π*im*rand(eltype(grid), size(sol)))/sqrt(clock.dt)\n  @. Fh = ξ*sqrt.(forcing_spectrum)\n  Fh[abs.(grid.Krsq).==0] .= 0\n  nothing\nend\nnothing # hide","category":"page"},{"location":"generated/barotropicqgql_betaforced/#Problem-setup-1","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Problem setup","text":"","category":"section"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"We initialize a Problem by providing a set of keyword arguments. Not providing a viscosity coefficient ν leads to the module's default value: ν=0. In this example numerical instability due to accumulation of enstrophy in high wavenumbers is taken care with the FilteredTimestepper we picked.","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"prob = BarotropicQGQL.Problem(nx=nx, Lx=Lx, beta=β, mu=μ, dt=dt, stepper=stepper,\n                              calcF=calcF!, stochastic=true)\nnothing # hide","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"and define some shortcuts.","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"sol, cl, vs, pr, gr = prob.sol, prob.clock, prob.vars, prob.params, prob.grid\nx, y = gr.x, gr.y\nnothing # hide","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"First let's see how a forcing realization looks like.","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"calcF!(vs.Fh, sol, 0.0, cl, vs, pr, gr)\n\nheatmap(x, y, irfft(vs.Fh, gr.nx),\n     aspectratio = 1,\n               c = :balance,\n            clim = (-8, 8),\n           xlims = (-gr.Lx/2, gr.Lx/2),\n           ylims = (-gr.Ly/2, gr.Ly/2),\n          xticks = -3:3,\n          yticks = -3:3,\n          xlabel = \"x\",\n          ylabel = \"y\",\n           title = \"a forcing realization\",\n      framestyle = :box)","category":"page"},{"location":"generated/barotropicqgql_betaforced/#Setting-initial-conditions-1","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Setting initial conditions","text":"","category":"section"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"Our initial condition is simply fluid at rest.","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"BarotropicQGQL.set_zeta!(prob, zeros(gr.nx, gr.ny))\nnothing # hide","category":"page"},{"location":"generated/barotropicqgql_betaforced/#Diagnostics-1","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Diagnostics","text":"","category":"section"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"Create Diagnostics – energy and enstrophy are functions imported at the top.","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"E = Diagnostic(energy, prob; nsteps=nsteps)\nZ = Diagnostic(enstrophy, prob; nsteps=nsteps)\nnothing # hide","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"We can also define our custom diagnostics via functions.","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"function zetaMean(prob)\n  sol = prob.sol\n  sol[1, :]\nend\n\nzMean = Diagnostic(zetaMean, prob; nsteps=nsteps, freq=10)  # the zonal-mean vorticity\nnothing # hide","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"We combile all diags in a list.","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"diags = [E, Z, zMean] # A list of Diagnostics types passed to \"stepforward!\" will  be updated every timestep.\nnothing # hide","category":"page"},{"location":"generated/barotropicqgql_betaforced/#Output-1","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Output","text":"","category":"section"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"We choose folder for outputing .jld2 files and snapshots (.png files).","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"filepath = \".\"\nplotpath = \"./plots_forcedbetaQLturb\"\nplotname = \"snapshots\"\nfilename = joinpath(filepath, \"forcedbetaQLturb.jld2\")\nnothing # hide","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"Do some basic file management,","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"if isfile(filename); rm(filename); end\nif !isdir(plotpath); mkdir(plotpath); end\nnothing # hide","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"and then create Output.","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"get_sol(prob) = sol # extracts the Fourier-transformed solution\nget_u(prob) = irfft(im*g.l.*g.invKrsq.*sol, g.nx)\nout = Output(prob, filename, (:sol, get_sol), (:u, get_u))\nnothing # hide","category":"page"},{"location":"generated/barotropicqgql_betaforced/#Visualizing-the-simulation-1","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Visualizing the simulation","text":"","category":"section"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"We define a function that plots the vorticity and streamfunction fields, the corresponding zonal-mean vorticity and zonal-mean zonal velocity and timeseries of energy and enstrophy.","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"function plot_output(prob)\n  ζ̄, ζ′= prob.vars.Zeta, prob.vars.zeta\n  ζ = @. ζ̄ + ζ′\n  ψ̄, ψ′= prob.vars.Psi,  prob.vars.psi\n  ψ = @. ψ̄ + ψ′\n  ζ̄ₘ = mean(ζ̄, dims=1)'\n  ūₘ = mean(prob.vars.U, dims=1)'\n\n  pζ = heatmap(x, y, ζ,\n       aspectratio = 1,\n            legend = false,\n                 c = :balance,\n              clim = (-8, 8),\n             xlims = (-gr.Lx/2, gr.Lx/2),\n             ylims = (-gr.Ly/2, gr.Ly/2),\n            xticks = -3:3,\n            yticks = -3:3,\n            xlabel = \"x\",\n            ylabel = \"y\",\n             title = \"vorticity ζ=∂v/∂x-∂u/∂y\",\n        framestyle = :box)\n\n  pψ = contourf(x, y, ψ,\n            levels = -0.32:0.04:0.32,\n       aspectratio = 1,\n         linewidth = 1,\n            legend = false,\n              clim = (-0.22, 0.22),\n                 c = :viridis,\n             xlims = (-gr.Lx/2, gr.Lx/2),\n             ylims = (-gr.Ly/2, gr.Ly/2),\n            xticks = -3:3,\n            yticks = -3:3,\n            xlabel = \"x\",\n            ylabel = \"y\",\n             title = \"streamfunction ψ\",\n        framestyle = :box)\n\n  pζm = plot(ζ̄ₘ, y,\n            legend = false,\n         linewidth = 2,\n             alpha = 0.7,\n            yticks = -3:3,\n             xlims = (-3, 3),\n            xlabel = \"zonal mean ζ\",\n            ylabel = \"y\")\n  plot!(pζm, 0*y, y, linestyle=:dash, linecolor=:black)\n\n  pum = plot(ūₘ, y,\n            legend = false,\n         linewidth = 2,\n             alpha = 0.7,\n            yticks = -3:3,\n             xlims = (-0.5, 0.5),\n            xlabel = \"zonal mean u\",\n            ylabel = \"y\")\n  plot!(pum, 0*y, y, linestyle=:dash, linecolor=:black)\n\n  pE = plot(1,\n             label = \"energy\",\n         linewidth = 2,\n             alpha = 0.7,\n             xlims = (-0.1, 4.1),\n             ylims = (0, 0.05),\n            xlabel = \"μt\")\n\n  pZ = plot(1,\n             label = \"enstrophy\",\n         linecolor = :red,\n            legend = :bottomright,\n         linewidth = 2,\n             alpha = 0.7,\n             xlims = (-0.1, 4.1),\n             ylims = (0, 5),\n            xlabel = \"μt\")\n\n  l = @layout grid(2, 3)\n  p = plot(pζ, pζm, pE, pψ, pum, pZ, layout=l, size = (1000, 600), dpi=150)\n\n  return p\nend","category":"page"},{"location":"generated/barotropicqgql_betaforced/#Time-stepping-the-Problem-forward-1","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Time-stepping the Problem forward","text":"","category":"section"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"We time-step the Problem forward in time.","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"p = plot_output(prob)\n\nstartwalltime = time()\n\nanim = @animate for j=0:Int(nsteps/nsubs)\n\n  cfl = cl.dt*maximum([maximum(vs.v)/gr.dy, maximum(vs.u+vs.U)/gr.dx])\n\n  log = @sprintf(\"step: %04d, t: %d, cfl: %.2f, E: %.4f, Q: %.4f, walltime: %.2f min\",\n    cl.step, cl.t, cfl, E.data[E.i], Z.data[Z.i],\n    (time()-startwalltime)/60)\n\n  if j%(1000/nsubs)==0; println(log) end\n\n  p[1][1][:z] = @. vs.zeta + vs.Zeta\n  p[1][:title] = \"vorticity, μt=\"*@sprintf(\"%.2f\", μ*cl.t)\n  p[4][1][:z] = @. vs.psi + vs.Psi\n  p[2][1][:x] = mean(vs.Zeta, dims=1)'\n  p[5][1][:x] = mean(vs.U, dims=1)'\n  push!(p[3][1], μ*E.t[E.i], E.data[E.i])\n  push!(p[6][1], μ*Z.t[Z.i], Z.data[Z.i])\n\n  stepforward!(prob, diags, nsubs)\n  BarotropicQGQL.updatevars!(prob)\n\nend\n\nmp4(anim, \"barotropicqgql_betaforced.mp4\", fps=18)","category":"page"},{"location":"generated/barotropicqgql_betaforced/#Save-1","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Save","text":"","category":"section"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"Finally save the last snapshot.","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"savename = @sprintf(\"%s_%09d.png\", joinpath(plotpath, plotname), cl.step)\nsavefig(savename)","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"","category":"page"},{"location":"generated/barotropicqgql_betaforced/#","page":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","title":"Quasi-Linear forced-dissipative barotropic QG beta-plane turbulence","text":"This page was generated using Literate.jl.","category":"page"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"EditURL = \"https://github.com/FourierFlows/GeophysicalFlows.jl/blob/master/examples/multilayerqg_2layer.jl\"","category":"page"},{"location":"generated/multilayerqg_2layer/#Phillips-model-of-Baroclinic-Instability-1","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"","category":"section"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"This example can be run online via (Image: ). Also, it can be viewed as a Jupyter notebook via (Image: ).","category":"page"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"A simulation of the growth of barolinic instability in the Phillips 2-layer model when we impose a vertical mean flow shear as a difference Delta U in the imposed, domain-averaged, zonal flow at each layer.","category":"page"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"using FourierFlows, Plots, Printf\n\nusing FFTW: rfft, irfft\nimport GeophysicalFlows.MultilayerQG\nimport GeophysicalFlows.MultilayerQG: energies","category":"page"},{"location":"generated/multilayerqg_2layer/#Numerical-parameters-and-time-stepping-parameters-1","page":"Phillips model of Baroclinic Instability","title":"Numerical parameters and time-stepping parameters","text":"","category":"section"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"nx = 128          # 2D resolution = nx^2\nny = nx\n\nstepper = \"FilteredRK4\"   # timestepper\ndt = 6e-3       # timestep\nnsteps = 7000  # total number of time-steps\nnsubs  = 25     # number of time-steps for plotting (nsteps must be multiple of nsubs)\nnothing # hide","category":"page"},{"location":"generated/multilayerqg_2layer/#Physical-parameters-1","page":"Phillips model of Baroclinic Instability","title":"Physical parameters","text":"","category":"section"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"Lx = 2π         # domain size\n μ = 5e-2       # bottom drag\n β = 5          # the y-gradient of planetary PV\n\nnlayers = 2     # number of layers\nf0, g = 1, 1    # Coriolis parameter and gravitational constant\n H = [0.2, 0.8] # the rest depths of each layer\n ρ = [4.0, 5.0] # the density of each layer\n\n U = zeros(nlayers) # the imposed mean zonal flow in each layer\n U[1] = 1.0\n U[2] = 0.0\nnothing # hide","category":"page"},{"location":"generated/multilayerqg_2layer/#Problem-setup-1","page":"Phillips model of Baroclinic Instability","title":"Problem setup","text":"","category":"section"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"We initialize a Problem by providing a set of keyword arguments,","category":"page"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"prob = MultilayerQG.Problem(nlayers=nlayers, nx=nx, Lx=Lx, f0=f0, g=g, H=H, ρ=ρ, U=U, dt=dt, stepper=stepper, μ=μ, β=β)\nnothing # hide","category":"page"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"and define some shortcuts.","category":"page"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"sol, cl, pr, vs, gr = prob.sol, prob.clock, prob.params, prob.vars, prob.grid\nx, y = gr.x, gr.y\nnothing # hide","category":"page"},{"location":"generated/multilayerqg_2layer/#Setting-initial-conditions-1","page":"Phillips model of Baroclinic Instability","title":"Setting initial conditions","text":"","category":"section"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"Our initial condition is some small amplitude random noise. We smooth our initial condidtion using the timestepper's high-wavenumber filter.","category":"page"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"q_i  = 4e-3randn((nx, ny, nlayers))\nqh_i = prob.timestepper.filter .* rfft(q_i, (1, 2)) # only apply rfft in dims=1, 2\nq_i  = irfft(qh_i, gr.nx, (1, 2)) # only apply irfft in dims=1, 2\n\nMultilayerQG.set_q!(prob, q_i)\nnothing # hide","category":"page"},{"location":"generated/multilayerqg_2layer/#Diagnostics-1","page":"Phillips model of Baroclinic Instability","title":"Diagnostics","text":"","category":"section"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"Create Diagnostics – energies function is imported at the top.","category":"page"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"E = Diagnostic(energies, prob; nsteps=nsteps)\ndiags = [E] # A list of Diagnostics types passed to \"stepforward!\" will  be updated every timestep.\nnothing # hide","category":"page"},{"location":"generated/multilayerqg_2layer/#Output-1","page":"Phillips model of Baroclinic Instability","title":"Output","text":"","category":"section"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"We choose folder for outputing .jld2 files and snapshots (.png files).","category":"page"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"filepath = \".\"\nplotpath = \"./plots_2layer\"\nplotname = \"snapshots\"\nfilename = joinpath(filepath, \"2layer.jld2\")\nnothing # hide","category":"page"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"Do some basic file management","category":"page"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"if isfile(filename); rm(filename); end\nif !isdir(plotpath); mkdir(plotpath); end\nnothing # hide","category":"page"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"And then create Output","category":"page"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"get_sol(prob) = sol # extracts the Fourier-transformed solution\nfunction get_u(prob)\n  @. v.qh = sol\n  streamfunctionfrompv!(v.psih, v.qh, p.invS, g)\n  @. v.uh = -im*g.l *v.psih\n  invtransform!(v.u, v.uh, p)\n  return v.u\nend\nout = Output(prob, filename, (:sol, get_sol), (:u, get_u))\nnothing #hide","category":"page"},{"location":"generated/multilayerqg_2layer/#Visualizing-the-simulation-1","page":"Phillips model of Baroclinic Instability","title":"Visualizing the simulation","text":"","category":"section"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"We define a function that plots the potential vorticity field and the evolution of energy and enstrophy.","category":"page"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"function plot_output(prob)\n\n  l = @layout grid(2, 3)\n  p = plot(layout=l, size = (1000, 600), dpi=150)\n\n  for m in 1:nlayers\n    heatmap!(p[(m-1)*3+1], x, y, vs.q[:, :, m],\n         aspectratio = 1,\n              legend = false,\n                   c = :balance,\n               xlims = (-gr.Lx/2, gr.Lx/2),\n               ylims = (-gr.Ly/2, gr.Ly/2),\n              xticks = -3:3,\n              yticks = -3:3,\n              xlabel = \"x\",\n              ylabel = \"y\",\n               title = \"q_\"*string(m),\n          framestyle = :box)\n\n    contourf!(p[(m-1)*3+2], x, y, vs.psi[:, :, m],\n              levels = 8,\n         aspectratio = 1,\n              legend = false,\n                   c = :viridis,\n               xlims = (-gr.Lx/2, gr.Lx/2),\n               ylims = (-gr.Ly/2, gr.Ly/2),\n              xticks = -3:3,\n              yticks = -3:3,\n              xlabel = \"x\",\n              ylabel = \"y\",\n               title = \"ψ_\"*string(m),\n          framestyle = :box)\n  end\n\n  plot!(p[3], 2,\n             label = [\"KE1\" \"KE2\"],\n            legend = :bottomright,\n         linewidth = 2,\n             alpha = 0.7,\n             xlims = (-0.1, 2.35),\n             ylims = (5e-10, 1e0),\n            yscale = :log10,\n            yticks = 10.0.^(-9:2:0),\n            xlabel = \"μt\")\n\n  plot!(p[6], 1,\n             label = \"PE\",\n            legend = :bottomright,\n         linecolor = :red,\n         linewidth = 2,\n             alpha = 0.7,\n             xlims = (-0.1, 2.35),\n             ylims = (1e-10, 1e0),\n            yscale = :log10,\n            yticks = 10.0.^(-10:2:0),\n            xlabel = \"μt\")\n\nend\nnothing # hide","category":"page"},{"location":"generated/multilayerqg_2layer/#Time-stepping-the-Problem-forward-1","page":"Phillips model of Baroclinic Instability","title":"Time-stepping the Problem forward","text":"","category":"section"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"Finally, we time-step the Problem forward in time.","category":"page"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"p = plot_output(prob)\n\nstartwalltime = time()\n\nanim = @animate for j=0:Int(nsteps/nsubs)\n\n  cfl = cl.dt*maximum([maximum(vs.u)/gr.dx, maximum(vs.v)/gr.dy])\n\n  log = @sprintf(\"step: %04d, t: %d, cfl: %.2f, KE1: %.4f, KE2: %.4f, PE: %.4f, walltime: %.2f min\", cl.step, cl.t, cfl, E.data[E.i][1][1], E.data[E.i][1][2], E.data[E.i][2][1], (time()-startwalltime)/60)\n\n  if j%(1000/nsubs)==0; println(log) end\n\n  for m in 1:nlayers\n    p[(m-1)*3+1][1][:z] = @. vs.q[:, :, m]\n    p[(m-1)*3+2][1][:z] = @. vs.psi[:, :, m]\n  end\n\n  push!(p[3][1], μ*E.t[E.i], E.data[E.i][1][1])\n  push!(p[3][2], μ*E.t[E.i], E.data[E.i][1][2])\n  push!(p[6][1], μ*E.t[E.i], E.data[E.i][2][1])\n\n  stepforward!(prob, diags, nsubs)\n  MultilayerQG.updatevars!(prob)\nend\n\nmp4(anim, \"multilayerqg_2layer.mp4\", fps=18)","category":"page"},{"location":"generated/multilayerqg_2layer/#Save-1","page":"Phillips model of Baroclinic Instability","title":"Save","text":"","category":"section"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"Finally save the last snapshot.","category":"page"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"savename = @sprintf(\"%s_%09d.png\", joinpath(plotpath, plotname), cl.step)\nsavefig(savename)","category":"page"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"","category":"page"},{"location":"generated/multilayerqg_2layer/#","page":"Phillips model of Baroclinic Instability","title":"Phillips model of Baroclinic Instability","text":"This page was generated using Literate.jl.","category":"page"},{"location":"modules/barotropicqg/#BarotropicQG-Module-1","page":"BarotropicQG Module","title":"BarotropicQG Module","text":"","category":"section"},{"location":"modules/barotropicqg/#Basic-Equations-1","page":"BarotropicQG Module","title":"Basic Equations","text":"","category":"section"},{"location":"modules/barotropicqg/#","page":"BarotropicQG Module","title":"BarotropicQG Module","text":"This module solves the quasi-geostrophic barotropic vorticity equation on a beta-plane of variable fluid depth H-h(xy). The flow is obtained through a streamfunction psi as (u upsilon) = (-partial_ypsi partial_xpsi). All flow fields can be obtained from the quasi-geostrophic potential vorticity (QGPV). Here the QGPV is","category":"page"},{"location":"modules/barotropicqg/#","page":"BarotropicQG Module","title":"BarotropicQG Module","text":"underbracef_0 + beta y_textplanetary PV + underbrace(partial_x upsilon\n\t- partial_y u)_textrelative vorticity +\n\tunderbracefracf_0 hH_texttopographic PV","category":"page"},{"location":"modules/barotropicqg/#","page":"BarotropicQG Module","title":"BarotropicQG Module","text":"The dynamical variable is the component of the vorticity of the flow normal to the plane of motion, zetaequiv partial_x upsilon- partial_y u = nabla^2psi. Also, we denote the topographic PV with etaequiv f_0 hH. Thus, the equation solved by the module is:","category":"page"},{"location":"modules/barotropicqg/#","page":"BarotropicQG Module","title":"BarotropicQG Module","text":"partial_t zeta + mathsfJ(psi underbracezeta + eta_equiv q) +\nbetapartial_xpsi = underbrace-leftmu + nu(-1)^n_nu nabla^2n_nu\nright zeta _textrmdissipation + f ","category":"page"},{"location":"modules/barotropicqg/#","page":"BarotropicQG Module","title":"BarotropicQG Module","text":"where mathsfJ(a b) = (partial_x a)(partial_y b)-(partial_y a)(partial_x b). On the right hand side, f(xyt) is forcing, mu is linear drag, and nu is hyperviscosity. Plain old viscosity corresponds to n_nu=1. The sum of relative vorticity and topographic PV is denoted with qequivzeta+eta.","category":"page"},{"location":"modules/barotropicqg/#Implementation-1","page":"BarotropicQG Module","title":"Implementation","text":"","category":"section"},{"location":"modules/barotropicqg/#","page":"BarotropicQG Module","title":"BarotropicQG Module","text":"The equation is time-stepped forward in Fourier space:","category":"page"},{"location":"modules/barotropicqg/#","page":"BarotropicQG Module","title":"BarotropicQG Module","text":"partial_t widehatzeta = - widehatmathsfJ(psi q) +betafracmathrmik_xk^2widehatzeta -left(mu\n+nu k^2n_nuright) widehatzeta  + widehatf ","category":"page"},{"location":"modules/barotropicqg/#","page":"BarotropicQG Module","title":"BarotropicQG Module","text":"In doing so the Jacobian is computed in the conservative form: mathsfJ(fg) = partial_y  (partial_x f) g -partial_x (partial_y f) g.","category":"page"},{"location":"modules/barotropicqg/#","page":"BarotropicQG Module","title":"BarotropicQG Module","text":"Thus:","category":"page"},{"location":"modules/barotropicqg/#","page":"BarotropicQG Module","title":"BarotropicQG Module","text":"mathcalL = betafracmathrmik_xk^2 - mu - nu k^2n_nu ","category":"page"},{"location":"modules/barotropicqg/#","page":"BarotropicQG Module","title":"BarotropicQG Module","text":"mathcalN(widehatzeta) = - mathrmik_x mathrmFFT(u q)-\n\tmathrmik_y mathrmFFT(upsilon q) ","category":"page"},{"location":"modules/barotropicqg/#Examples-1","page":"BarotropicQG Module","title":"Examples","text":"","category":"section"},{"location":"modules/barotropicqg/#","page":"BarotropicQG Module","title":"BarotropicQG Module","text":"examples/barotropicqg_betadecay.jl: A script that simulates decaying quasi-geostrophic flow on a beta-plane demonstrating zonation.\nexamples/barotropicqg_betaforced.jl: A script that simulates forced-dissipative quasi-geostrophic flow on a beta-plane demonstrating zonation. The forcing is temporally delta-correlated and its spatial structure is isotropic with power in a narrow annulus of total radius kf in wavenumber space.\nexamples/barotropicqg_acc.jl: A script that simulates barotropic quasi-geostrophic flow above topography reproducing the results of the paper by\nConstantinou, N. C. (2018). A barotropic model of eddy saturation. J. Phys. Oceanogr., 48 (2), 397-411.","category":"page"},{"location":"modules/barotropicqgql/#BarotropicQGQL-Module-1","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"","category":"section"},{"location":"modules/barotropicqgql/#Basic-Equations-1","page":"BarotropicQGQL Module","title":"Basic Equations","text":"","category":"section"},{"location":"modules/barotropicqgql/#","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"This module solves the quasi-linear quasi-geostrophic barotropic vorticity equation on a beta-plane of variable fluid depth H-h(xy).  Quasi-linear refers to the dynamics that neglect the eddy–eddy interactions in the eddy evolution equation after an eddy–mean flow decomposition, e.g., ","category":"page"},{"location":"modules/barotropicqgql/#","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"phi(x y t) = overlinephi(y t) + phi(xyt) ","category":"page"},{"location":"modules/barotropicqgql/#","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"where overline above denotes a zonal mean, overlinephi(y t) = int phi(x y t)mathrmdxL_x, and prime denotes deviations from the zonal mean. This approximation is used in many process-model studies of zonation, e.g., ","category":"page"},{"location":"modules/barotropicqgql/#","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"Farrell, B. F. and Ioannou, P. J. (2003). Structural stability of turbulent jets. J. Atmos. Sci., 60, 2101-2118.\nSrinivasan, K. and Young, W. R. (2012). Zonostrophic instability. J. Atmos. Sci., 69 (5), 1633-1656.\nConstantinou, N. C., Farrell, B. F., and Ioannou, P. J. (2014). Emergence and equilibration of jets in beta-plane turbulence: applications of Stochastic Structural Stability Theory. J. Atmos. Sci., 71 (5), 1818-1842.","category":"page"},{"location":"modules/barotropicqgql/#","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"As in the BarotropicQG module, the flow is obtained through a streamfunction psi as (u upsilon) = (-partial_ypsi partial_xpsi). All flow fields can be obtained from the quasi-geostrophic potential vorticity (QGPV). Here the QGPV is","category":"page"},{"location":"modules/barotropicqgql/#","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"underbracef_0 + beta y_textplanetary PV + underbrace(partial_x upsilon\n\t- partial_y u)_textrelative vorticity +\n\tunderbracefracf_0 hH_texttopographic PV","category":"page"},{"location":"modules/barotropicqgql/#","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"The dynamical variable is the component of the vorticity of the flow normal to the plane of motion, zetaequiv partial_x upsilon- partial_y u = nabla^2psi. Also, we denote the topographic PV with etaequiv f_0 hH. After we apply the eddy-mean flow decomposition above, the QGPV dynamics are:","category":"page"},{"location":"modules/barotropicqgql/#","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"partial_t overlinezeta + mathsfJ(overlinepsi underbraceoverlinezeta + overlineeta_equiv overlineq) + overlinemathsfJ(psi underbracezeta + eta_equiv q) = underbrace-leftmu + nu(-1)^n_nu nabla^2n_nu\nright overlinezeta _textrmdissipation  ","category":"page"},{"location":"modules/barotropicqgql/#","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"partial_t zeta + mathsfJ(psi overlineq) + mathsfJ(overlinepsi q) + underbracemathsfJ(psi q) - overlinemathsfJ(psi q)_textrmEENL + \nbetapartial_xpsi = underbrace-leftmu + nu(-1)^n_nu nabla^2n_nu\nright zeta_textrmdissipation + f ","category":"page"},{"location":"modules/barotropicqgql/#","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"where mathsfJ(a b) = (partial_x a)(partial_y b)-(partial_y a)(partial_x b). On the right hand side, f(xyt) is forcing (which is assumed to have zero mean, overlinef=0), mu is linear drag, and nu is hyperviscosity. Plain old viscosity corresponds to n_nu=1. The sum of relative vorticity and topographic PV is denoted with qequivzeta+eta.","category":"page"},{"location":"modules/barotropicqgql/#","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"Quasi-linear dynamics neglect the term eddy-eddy nonlinearity (EENL) term above.","category":"page"},{"location":"modules/barotropicqgql/#Implementation-1","page":"BarotropicQGQL Module","title":"Implementation","text":"","category":"section"},{"location":"modules/barotropicqgql/#","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"The equation is time-stepped forward in Fourier space:","category":"page"},{"location":"modules/barotropicqgql/#","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"partial_t widehatzeta = - widehatmathsfJ(psi q)^textrmQL +betafracmathrmik_xk^2widehatzeta -left(mu\n+nu k^2n_nuright) widehatzeta  + widehatf ","category":"page"},{"location":"modules/barotropicqgql/#","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"In doing so the Jacobian is computed in the conservative form: mathsfJ(fg) = partial_y  (partial_x f) g -partial_x (partial_y f) g. The superscript QL in the Jacobian term above denotes that remove triad interactions that correspond to the EENL term.","category":"page"},{"location":"modules/barotropicqgql/#","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"Thus:","category":"page"},{"location":"modules/barotropicqgql/#","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"mathcalL = betafracmathrmik_xk^2 - mu - nu k^2n_nu ","category":"page"},{"location":"modules/barotropicqgql/#","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"mathcalN(widehatzeta) = - mathrmik_x mathrmFFT(u q)^textrmQL-\n\tmathrmik_y mathrmFFT(upsilon q)^textrmQL ","category":"page"},{"location":"modules/barotropicqgql/#Examples-1","page":"BarotropicQGQL Module","title":"Examples","text":"","category":"section"},{"location":"modules/barotropicqgql/#","page":"BarotropicQGQL Module","title":"BarotropicQGQL Module","text":"examples/barotropicqgql_betaforced.jl: A script that simulates forced-dissipative quasi-linear quasi-geostrophic flow on a beta-plane demonstrating zonation. The forcing is temporally delta-correlated and its spatial structure is isotropic with power in a narrow annulus of total radius kf in wavenumber space. This example demonstrates that the anisotropic inverse energy cascade is not required for zonation.","category":"page"},{"location":"modules/twodnavierstokes/#TwoDNavierStokes-Module-1","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"","category":"section"},{"location":"modules/twodnavierstokes/#Basic-Equations-1","page":"TwoDNavierStokes Module","title":"Basic Equations","text":"","category":"section"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"This module solves two-dimensional incompressible turbulence. The flow is given through a streamfunction psi as (uupsilon) = (-partial_ypsi partial_xpsi). The dynamical variable used here is the component of the vorticity of the flow normal to the plane of motion, zeta=partial_x upsilon- partial_y u = nabla^2psi. The equation solved by the module is:","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"partial_t zeta + mathsfJ(psi zeta) = underbrace-leftmu(-1)^n_mu nabla^2n_mu\n+nu(-1)^n_nu nabla^2n_nuright zeta_textrmdissipation + f ","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"where mathsfJ(a b) = (partial_x a)(partial_y b)-(partial_y a)(partial_x b). On the right hand side, f(xyt) is forcing, mu is hypoviscosity, and nu is hyperviscosity. Plain old linear drag corresponds to n_mu=0, while normal viscosity corresponds to n_nu=1.","category":"page"},{"location":"modules/twodnavierstokes/#Implementation-1","page":"TwoDNavierStokes Module","title":"Implementation","text":"","category":"section"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"The equation is time-stepped forward in Fourier space:","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"partial_t widehatzeta = - widehatmathsfJ(psi zeta) -left(mu k^2n_mu\n+nu k^2n_nuright) widehatzeta  + widehatf ","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"In doing so the Jacobian is computed in the conservative form: mathsfJ(ab) = partial_y  (partial_x a) b -partial_x (partial_y a) b.","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"Thus:","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"mathcalL = -mu k^-2n_mu - nu k^2n_nu ","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"mathcalN(widehatzeta) = - mathrmik_x mathrmFFT(u zeta)-\n\tmathrmik_y mathrmFFT(upsilon zeta) + widehatf ","category":"page"},{"location":"modules/twodnavierstokes/#AbstractTypes-and-Functions-1","page":"TwoDNavierStokes Module","title":"AbstractTypes and Functions","text":"","category":"section"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"Params","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"For the unforced case (f=0) parameters AbstractType is build with Params and it includes:","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"ν:   Float; viscosity or hyperviscosity coefficient.\nnν: Integer0; the order of viscosity n_nu. Case n_nu=1 gives normal viscosity.\nμ: Float; bottom drag or hypoviscosity coefficient.\nnμ: Integerge 0; the order of hypodrag n_mu. Case n_mu=0 gives plain linear drag mu.","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"For the forced case (fne 0) parameters AbstractType is build with ForcedParams. It includes all parameters in Params and additionally:","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"calcF!: Function that calculates the forcing widehatf","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"Vars","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"For the unforced case (f=0) variables AbstractType is build with Vars and it includes:","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"zeta: Array of Floats; relative vorticity.\nu: Array of Floats; x-velocity, u.\nv: Array of Floats; y-velocity, upsilon.\nsol: Array of Complex; the solution, widehatzeta.\nzetah: Array of Complex; the Fourier transform widehatzeta.\nuh: Array of Complex; the Fourier transform widehatu.\nvh: Array of Complex; the Fourier transform widehatupsilon.","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"For the forced case (fne 0) variables AbstractType is build with ForcedVars. It includes all variables in Vars and additionally:","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"Fh: Array of Complex; the Fourier transform widehatf.\nprevsol: Array of Complex; the values of the solution sol at the previous time-step (useful for calculating the work done by the forcing).","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"calcN! function","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"The nonlinear term mathcalN(widehatzeta) is computed via functions:","category":"page"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"calcN_advection!: computes - widehatmathsfJ(psi zeta) and stores it in array N.\ncalcN_forced!: computes - widehatmathsfJ(psi zeta) via calcN_advection! and then adds to it the forcing widehatf computed via calcF! function. Also saves the solution widehatzeta of the previous time-step in array prevsol.\nupdatevars!: uses sol to compute zeta, u, upsilon, widehatu, and widehatupsilon and stores them into corresponding arrays of Vars/ForcedVars.","category":"page"},{"location":"modules/twodnavierstokes/#Examples-1","page":"TwoDNavierStokes Module","title":"Examples","text":"","category":"section"},{"location":"modules/twodnavierstokes/#","page":"TwoDNavierStokes Module","title":"TwoDNavierStokes Module","text":"examples/twodnavierstokes_decaying.jl: A script that simulates decaying two-dimensional turbulence reproducing the results of the paper by\nMcWilliams, J. C. (1984). The emergence of isolated coherent vortices in turbulent flow. J. Fluid Mech., 146, 21-43.\nexamples/twodnavierstokes_stochasticforcing.jl: A script that simulates forced-dissipative two-dimensional turbulence with isotropic temporally delta-correlated stochastic forcing.","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"EditURL = \"https://github.com/FourierFlows/GeophysicalFlows.jl/blob/master/examples/twodnavierstokes_stochasticforcing.jl\"","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#D-forced-dissipative-turbulence-1","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"","category":"section"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"This example can be run online via (Image: ). Also, it can be viewed as a Jupyter notebook via (Image: ).","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"A simulation of forced-dissipative two-dimensional turbulence. We solve the two-dimensional vorticity equation with stochastic excitation and dissipation in the form of linear drag and hyperviscosity. As a demonstration, we compute how each of the forcing and dissipation terms contribute to the energy budget.","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"using FourierFlows, Printf, Plots\n\nusing FourierFlows: parsevalsum\nusing Random: seed!\nusing FFTW: irfft\n\nimport GeophysicalFlows.TwoDNavierStokes\nimport GeophysicalFlows.TwoDNavierStokes: energy, enstrophy, dissipation, work, drag","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#Choosing-a-device:-CPU-or-GPU-1","page":"2D forced-dissipative turbulence","title":"Choosing a device: CPU or GPU","text":"","category":"section"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"dev = CPU()    # Device (CPU/GPU)\nnothing # hide","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#Numerical,-domain,-and-simulation-parameters-1","page":"2D forced-dissipative turbulence","title":"Numerical, domain, and simulation parameters","text":"","category":"section"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"First, we pick some numerical and physical parameters for our model.","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":" n, L  = 256, 2π             # grid resolution and domain length\n ν, nν = 2e-7, 2             # hyperviscosity coefficient and order\n μ, nμ = 1e-1, 0             # linear drag coefficient\ndt, tf = 0.005, 0.2/μ        # timestep and final time\n    nt = round(Int, tf/dt)   # total timesteps\n    ns = 4                   # how many intermediate times we want to plot\nnothing # hide","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#Forcing-1","page":"2D forced-dissipative turbulence","title":"Forcing","text":"","category":"section"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"We force the vorticity equation with stochastic excitation that is delta-correlated in time and while spatially homogeneously and isotropically correlated. The forcing has a spectrum with power in a ring in wavenumber space of radious k_f and width delta k_f, and it injects energy per unit area and per unit time equal to varepsilon.","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"forcing_wavenumber = 14.0    # the central forcing wavenumber for a spectrum that is a ring in wavenumber space\nforcing_bandwidth  = 1.5     # the width of the forcing spectrum\nε = 0.001                    # energy input rate by the forcing\n\ngr   = TwoDGrid(dev, n, L)\nx, y = gr.x, gr.y\n\nforcing_spectrum = @. exp(-(sqrt(gr.Krsq)-forcing_wavenumber)^2/(2*forcing_bandwidth^2))\nforcing_spectrum[ gr.Krsq .< (2π/L*2)^2 ]  .= 0 # make sure that focing has no power for low wavenumbers\nforcing_spectrum[ gr.Krsq .> (2π/L*20)^2 ] .= 0 # make sure that focing has no power for high wavenumbers\nε0 = parsevalsum(forcing_spectrum.*gr.invKrsq/2.0, gr)/(gr.Lx*gr.Ly)\nforcing_spectrum .= ε/ε0 * forcing_spectrum # normalize forcing to inject energy ε\n\nseed!(1234)\nnothing # hide","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"Next we construct function calcF! that computes a forcing realization every timestep","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"function calcF!(Fh, sol, t, cl, v, p, g)\n  ξ = ArrayType(dev)(exp.(2π*im*rand(eltype(gr), size(sol)))/sqrt(cl.dt))\n  ξ[1, 1] = 0\n  @. Fh = ξ*sqrt(forcing_spectrum)\n  nothing\nend\nnothing # hide","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#Problem-setup-1","page":"2D forced-dissipative turbulence","title":"Problem setup","text":"","category":"section"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"We initialize a Problem by providing a set of keyword arguments. The stepper keyword defines the time-stepper to be used.","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"prob = TwoDNavierStokes.Problem(nx=n, Lx=L, ν=ν, nν=nν, μ=μ, nμ=nμ, dt=dt, stepper=\"ETDRK4\",\n                                calcF=calcF!, stochastic=true, dev=dev)\nnothing # hide","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"Define some shortcuts for convenience.","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"sol, cl, v, p, g = prob.sol, prob.clock, prob.vars, prob.params, prob.grid\nnothing # hide","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"First let's see how a forcing realization looks like.","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"calcF!(v.Fh, sol, 0.0, cl, v, p, g)\n\nheatmap(x, y, irfft(v.Fh, g.nx),\n     aspectratio = 1,\n               c = :balance,\n            clim = (-200, 200),\n           xlims = (-L/2, L/2),\n           ylims = (-L/2, L/2),\n          xticks = -3:3,\n          yticks = -3:3,\n          xlabel = \"x\",\n          ylabel = \"y\",\n           title = \"a forcing realization\",\n      framestyle = :box)","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#Setting-initial-conditions-1","page":"2D forced-dissipative turbulence","title":"Setting initial conditions","text":"","category":"section"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"Our initial condition is simply fluid at rest.","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"TwoDNavierStokes.set_zeta!(prob, zeros(g.nx, g.ny))","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#Diagnostics-1","page":"2D forced-dissipative turbulence","title":"Diagnostics","text":"","category":"section"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"Create Diagnostics; the diagnostics are aimed to probe the energy budget.","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"E = Diagnostic(energy,      prob, nsteps=nt) # energy\nR = Diagnostic(drag,        prob, nsteps=nt) # dissipation by drag\nD = Diagnostic(dissipation, prob, nsteps=nt) # dissipation by hyperviscosity\nW = Diagnostic(work,        prob, nsteps=nt) # work input by forcing\ndiags = [E, D, W, R] # A list of Diagnostics types passed to \"stepforward!\" will  be updated every timestep.\nnothing # hide","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#Visualizing-the-simulation-1","page":"2D forced-dissipative turbulence","title":"Visualizing the simulation","text":"","category":"section"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"We define a function that plots the vorticity field and the evolution of the diagnostics: energy and all terms involved in the energy budget. Last we confirm whether the energy budget is accurate, i.e., mathrmdEmathrmdt = W - R - D.","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"function computetendencies_and_makeplot(prob, diags)\n  TwoDNavierStokes.updatevars!(prob)\n  E, D, W, R = diags\n\n  clocktime = round(μ*cl.t, digits=2)\n\n  i₀ = 1\n  dEdt_numerical = (E[(i₀+1):E.i] - E[i₀:E.i-1])/cl.dt #numerical first-order approximation of energy tendency\n  ii = (i₀):E.i-1\n  ii2 = (i₀+1):E.i\n\n  t = E.t[ii]\n  dEdt_computed = W[ii2] - D[ii] - R[ii]        # Stratonovich interpretation\n\n  residual = dEdt_computed - dEdt_numerical\n\n  l = @layout grid(2, 2)\n\n  p1 = heatmap(x, y, v.zeta,\n            aspectratio = 1,\n            legend = false,\n                 c = :viridis,\n              clim = (-25, 25),\n             xlims = (-L/2, L/2),\n             ylims = (-L/2, L/2),\n            xticks = -3:3,\n            yticks = -3:3,\n            xlabel = \"μt\",\n            ylabel = \"y\",\n             title = \"∇²ψ(x, y, t=\"*@sprintf(\"%.2f\", cl.t)*\")\",\n        framestyle = :box)\n\n  p2 = plot(μ*t, [W[ii2] ε.+0*t -D[ii] -R[ii]],\n             label = [\"work, W\" \"ensemble mean work, <W>\" \"dissipation, D\" \"drag, D=-2μE\"],\n         linestyle = [:solid :dash :solid :solid],\n         linewidth = 2,\n             alpha = 0.8,\n            xlabel = \"μt\",\n            ylabel = \"energy sources and sinks\")\n\n  p3 = plot(μ*t, [dEdt_computed[ii], dEdt_numerical],\n             label = [\"computed W-D\" \"numerical dE/dt\"],\n         linestyle = [:solid :dashdotdot],\n         linewidth = 2,\n             alpha = 0.8,\n            xlabel = \"μt\",\n            ylabel = \"dE/dt\")\n\n  p4 = plot(μ*t, residual,\n             label = \"residual dE/dt = computed - numerical\",\n         linewidth = 2,\n             alpha = 0.7,\n            xlabel = \"μt\")\n\n  p = plot(p1, p2, p3, p4, layout=l, size = (900, 800))\n  return p\nend\nnothing # hide","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#Time-stepping-the-Problem-forward-1","page":"2D forced-dissipative turbulence","title":"Time-stepping the Problem forward","text":"","category":"section"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"Finally, we time-step the Problem forward in time.","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"startwalltime = time()\nfor i = 1:ns\n  stepforward!(prob, diags, round(Int, nt/ns))\n  TwoDNavierStokes.updatevars!(prob)\n  cfl = cl.dt*maximum([maximum(v.u)/g.dx, maximum(v.v)/g.dy])\n\n  log = @sprintf(\"step: %04d, t: %.1f, cfl: %.3f, walltime: %.2f min\", cl.step, cl.t,\n        cfl, (time()-startwalltime)/60)\n\n  println(log)\nend","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#Plot-1","page":"2D forced-dissipative turbulence","title":"Plot","text":"","category":"section"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"And now let's see what we got. We plot the output.","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"p = computetendencies_and_makeplot(prob, diags)","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"","category":"page"},{"location":"generated/twodnavierstokes_stochasticforcing/#","page":"2D forced-dissipative turbulence","title":"2D forced-dissipative turbulence","text":"This page was generated using Literate.jl.","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"EditURL = \"https://github.com/FourierFlows/GeophysicalFlows.jl/blob/master/examples/twodnavierstokes_decaying.jl\"","category":"page"},{"location":"generated/twodnavierstokes_decaying/#D-decaying-turbulence-1","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"","category":"section"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"This example can be run online via (Image: ). Also, it can be viewed as a Jupyter notebook via (Image: ).","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"A simulation of decaying two-dimensional turbulence.","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"using FourierFlows, Printf, Random, Plots\n\nusing Random: seed!\nusing FFTW: rfft, irfft\n\nimport GeophysicalFlows.TwoDNavierStokes\nimport GeophysicalFlows.TwoDNavierStokes: energy, enstrophy\nimport GeophysicalFlows: peakedisotropicspectrum","category":"page"},{"location":"generated/twodnavierstokes_decaying/#Choosing-a-device:-CPU-or-GPU-1","page":"2D decaying turbulence","title":"Choosing a device: CPU or GPU","text":"","category":"section"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"dev = CPU()     # Device (CPU/GPU)\nnothing # hide","category":"page"},{"location":"generated/twodnavierstokes_decaying/#Numerical,-domain,-and-simulation-parameters-1","page":"2D decaying turbulence","title":"Numerical, domain, and simulation parameters","text":"","category":"section"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"First, we pick some numerical and physical parameters for our model.","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"n, L  = 128, 2π             # grid resolution and domain length\nnothing # hide\n\n# Then we pick the time-stepper parameters\n    dt = 1e-2  # timestep\nnsteps = 4000  # total number of steps\n nsubs = 20    # number of steps between each plot\nnothing # hide","category":"page"},{"location":"generated/twodnavierstokes_decaying/#Problem-setup-1","page":"2D decaying turbulence","title":"Problem setup","text":"","category":"section"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"We initialize a Problem by providing a set of keyword arguments. The stepper keyword defines the time-stepper to be used.","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"prob = TwoDNavierStokes.Problem(; nx=n, Lx=L, ny=n, Ly=L, dt=dt, stepper=\"FilteredRK4\", dev=dev)\nnothing # hide","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"Next we define some shortcuts for convenience.","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"sol, cl, vs, gr = prob.sol, prob.clock, prob.vars, prob.grid\nx, y = gr.x, gr.y\nnothing # hide","category":"page"},{"location":"generated/twodnavierstokes_decaying/#Setting-initial-conditions-1","page":"2D decaying turbulence","title":"Setting initial conditions","text":"","category":"section"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"Our initial condition closely tries to reproduce the initial condition used in the paper by McWilliams (JFM, 1984)","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"seed!(1234)\nk₀, E₀ = 6, 0.5\nζ₀ = peakedisotropicspectrum(gr, k₀, E₀, mask=prob.timestepper.filter)\nTwoDNavierStokes.set_zeta!(prob, ζ₀)\nnothing # hide","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"Let's plot the initial vorticity field:","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"heatmap(x, y, vs.zeta,\n         aspectratio = 1,\n              c = :balance,\n           clim = (-40, 40),\n          xlims = (-L/2, L/2),\n          ylims = (-L/2, L/2),\n         xticks = -3:3,\n         yticks = -3:3,\n         xlabel = \"x\",\n         ylabel = \"y\",\n          title = \"initial vorticity\",\n     framestyle = :box)","category":"page"},{"location":"generated/twodnavierstokes_decaying/#Diagnostics-1","page":"2D decaying turbulence","title":"Diagnostics","text":"","category":"section"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"Create Diagnostics – energy and enstrophy functions are imported at the top.","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"E = Diagnostic(energy, prob; nsteps=nsteps)\nZ = Diagnostic(enstrophy, prob; nsteps=nsteps)\ndiags = [E, Z] # A list of Diagnostics types passed to \"stepforward!\" will  be updated every timestep.\nnothing # hide","category":"page"},{"location":"generated/twodnavierstokes_decaying/#Output-1","page":"2D decaying turbulence","title":"Output","text":"","category":"section"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"We choose folder for outputing .jld2 files and snapshots (.png files).","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"filepath = \".\"\nplotpath = \"./plots_decayingTwoDNavierStokes\"\nplotname = \"snapshots\"\nfilename = joinpath(filepath, \"decayingTwoDNavierStokes.jld2\")\nnothing # hide","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"Do some basic file management","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"if isfile(filename); rm(filename); end\nif !isdir(plotpath); mkdir(plotpath); end\nnothing # hide","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"And then create Output","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"get_sol(prob) = Array(prob.sol) # extracts the Fourier-transformed solution\nget_u(prob) = Array(irfft(im*gr.l.*gr.invKrsq.*sol, gr.nx))\nout = Output(prob, filename, (:sol, get_sol), (:u, get_u))\nsaveproblem(out)\nnothing # hide","category":"page"},{"location":"generated/twodnavierstokes_decaying/#Visualizing-the-simulation-1","page":"2D decaying turbulence","title":"Visualizing the simulation","text":"","category":"section"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"We initialize a plot with the vorticity field and the time-series of energy and enstrophy diagnostics.","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"p1 = heatmap(x, y, vs.zeta,\n         aspectratio = 1,\n                   c = :balance,\n                clim = (-40, 40),\n               xlims = (-L/2, L/2),\n               ylims = (-L/2, L/2),\n              xticks = -3:3,\n              yticks = -3:3,\n              xlabel = \"x\",\n              ylabel = \"y\",\n               title = \"vorticity, t=\"*@sprintf(\"%.2f\", cl.t),\n          framestyle = :box)\n\np2 = plot(2, # this means \"a plot with two series\"\n               label = [\"energy E(t)/E(0)\" \"enstrophy Z(t)/Z(0)\"],\n              legend = :right,\n           linewidth = 2,\n               alpha = 0.7,\n              xlabel = \"t\",\n               xlims = (0, 41),\n               ylims = (0, 1.1))\n\nl = @layout grid(1, 2)\np = plot(p1, p2, layout = l, size = (900, 400))","category":"page"},{"location":"generated/twodnavierstokes_decaying/#Time-stepping-the-Problem-forward-1","page":"2D decaying turbulence","title":"Time-stepping the Problem forward","text":"","category":"section"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"We time-step the Problem forward in time.","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"startwalltime = time()\n\nanim = @animate for j = 0:Int(nsteps/nsubs)\n\n  log = @sprintf(\"step: %04d, t: %d, ΔE: %.4f, ΔZ: %.4f, walltime: %.2f min\",\n      cl.step, cl.t, E.data[E.i]/E.data[1], Z.data[Z.i]/Z.data[1], (time()-startwalltime)/60)\n\n  if j%(1000/nsubs)==0; println(log) end\n\n  p[1][1][:z] = vs.zeta\n  p[1][:title] = \"vorticity, t=\"*@sprintf(\"%.2f\", cl.t)\n  push!(p[2][1], E.t[E.i], E.data[E.i]/E.data[1])\n  push!(p[2][2], Z.t[Z.i], Z.data[Z.i]/Z.data[1])\n\n  stepforward!(prob, diags, nsubs)\n  TwoDNavierStokes.updatevars!(prob)\n\nend\n\nmp4(anim, \"twodturb.mp4\", fps=18)","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"Last we save the output.","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"saveoutput(out)","category":"page"},{"location":"generated/twodnavierstokes_decaying/#Radial-energy-spectrum-1","page":"2D decaying turbulence","title":"Radial energy spectrum","text":"","category":"section"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"After the simulation is done we plot the radial energy spectrum to illustrate how FourierFlows.radialspectrum can be used,","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"E  = @. 0.5*(vs.u^2 + vs.v^2) # energy density\nEh = rfft(E)                  # Fourier transform of energy density\nkr, Ehr = FourierFlows.radialspectrum(Eh, gr, refinement=1) # compute radial specturm of `Eh`\nnothing # hide","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"and we plot it.","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"plot(kr, abs.(Ehr),\n    linewidth = 2,\n        alpha = 0.7,\n       xlabel = \"kᵣ\", ylabel = \"∫ |Ê| kᵣ dk_θ\",\n        xlims = (5e-1, gr.nx),\n       xscale = :log10, yscale = :log10,\n        title = \"Radial energy spectrum\",\n       legend = false)","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"","category":"page"},{"location":"generated/twodnavierstokes_decaying/#","page":"2D decaying turbulence","title":"2D decaying turbulence","text":"This page was generated using Literate.jl.","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"EditURL = \"https://github.com/FourierFlows/GeophysicalFlows.jl/blob/master/examples/barotropicqg_acc.jl\"","category":"page"},{"location":"generated/barotropicqg_acc/#Barotropic-QG-beta-plane-turbulence-over-topography-1","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"","category":"section"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"This example can be run online via (Image: ). Also, it can be viewed as a Jupyter notebook via (Image: ).","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"An idealized version of the Southern Ocean. We solve the barotropic quasi-geostrophic eddy dynamics in a flud with variable depth H-h(xy). We also include an \"Antarctic Circumpolar Current,\" i.e.,  a domain-average zonal velocity U(t) which is forced by constant wind  stress F and influenced by bottom drag and topographic form stress. The equations solved are: partial_t nabla^2psi + mathsfJ(psi-U y nabla^2psi + beta y + eta) = -munabla^2psi and partial_t U = F - mu U -  langlepsipartial_xetarangle.","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"using FourierFlows, Plots, Printf\n\nusing FFTW: irfft\n\nimport GeophysicalFlows.BarotropicQG\nimport GeophysicalFlows.BarotropicQG: energy, meanenergy, enstrophy, meanenstrophy","category":"page"},{"location":"generated/barotropicqg_acc/#Choosing-a-device:-CPU-or-GPU-1","page":"Barotropic QG beta-plane turbulence over topography","title":"Choosing a device: CPU or GPU","text":"","category":"section"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"dev = CPU()     # Device (CPU/GPU)\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_acc/#Numerical-parameters-and-time-stepping-parameters-1","page":"Barotropic QG beta-plane turbulence over topography","title":"Numerical parameters and time-stepping parameters","text":"","category":"section"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"     nx = 128            # 2D resolution = nx^2\nstepper = \"FilteredRK4\"  # timestepper\n    dt  = 0.1            # timestep\n nsteps = 10000          # total number of time-steps\n nsubs  = 25             # number of time-steps for intermediate logging/plotting (nsteps must be multiple of nsubs)\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_acc/#Physical-parameters-1","page":"Barotropic QG beta-plane turbulence over topography","title":"Physical parameters","text":"","category":"section"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"Lx = 2π        # domain size\n ν = 4e-15     # viscosity\nnν = 4         # viscosity order\nf0 = -1.0      # Coriolis parameter\n β = 1.4015    # the y-gradient of planetary PV\n μ = 1e-2      # linear drag\n F = 0.0012    # normalized wind stress forcing on domain-averaged zonal flow U(t) flow\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"Define the topographic potential vorticity, f_0 h(x y)H","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"topoPV(x, y) = 2cos(4x)*cos(4y)\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"and the forcing function F (here forcing is constant in time) that acts on the domain-averaged U equation.","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"calcFU(t) = F\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_acc/#Problem-setup-1","page":"Barotropic QG beta-plane turbulence over topography","title":"Problem setup","text":"","category":"section"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"We initialize a Problem by providing a set of keyword arguments,","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"prob = BarotropicQG.Problem(nx=nx, Lx=Lx, f0=f0, β=β, eta=topoPV,\n                  calcFU=calcFU, ν=ν, nν=nν, μ=μ, dt=dt, stepper=stepper, dev=dev)\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"and define some shortcuts.","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"sol, cl, vs, pr, gr = prob.sol, prob.clock, prob.vars, prob.params, prob.grid\nx, y = gr.x, gr.y\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_acc/#Setting-initial-conditions-1","page":"Barotropic QG beta-plane turbulence over topography","title":"Setting initial conditions","text":"","category":"section"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"Our initial condition is simply fluid at rest.","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"BarotropicQG.set_zeta!(prob, zeros(gr.nx, gr.ny))","category":"page"},{"location":"generated/barotropicqg_acc/#Diagnostics-1","page":"Barotropic QG beta-plane turbulence over topography","title":"Diagnostics","text":"","category":"section"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"Create Diagnostics – energy, meanenergy, enstrophy, and meanenstrophy functions are imported at the top.","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"E = Diagnostic(energy, prob; nsteps=nsteps)\nQ = Diagnostic(enstrophy, prob; nsteps=nsteps)\nEmean = Diagnostic(meanenergy, prob; nsteps=nsteps)\nQmean = Diagnostic(meanenstrophy, prob; nsteps=nsteps)\ndiags = [E, Emean, Q, Qmean]\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_acc/#Output-1","page":"Barotropic QG beta-plane turbulence over topography","title":"Output","text":"","category":"section"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"We choose folder for outputing .jld2 files and snapshots (.png files).","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"filepath = \".\"\nplotpath = \"./plots_barotropicqgtopography\"\nplotname = \"snapshots\"\nfilename = joinpath(filepath, \"barotropicqgtopography.jld2\")\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"Do some basic file management,","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"if isfile(filename); rm(filename); end\nif !isdir(plotpath); mkdir(plotpath); end\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"and then create Output.","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"get_sol(prob) = sol # extracts the Fourier-transformed solution\nget_u(prob) = irfft(im*gr.lr.*gr.invKrsq.*sol, gr.nx)\nout = Output(prob, filename, (:sol, get_sol), (:u, get_u))\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_acc/#Visualizing-the-simulation-1","page":"Barotropic QG beta-plane turbulence over topography","title":"Visualizing the simulation","text":"","category":"section"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"We define a function that plots the potential vorticity field and the evolution of energy and enstrophy.","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"function plot_output(prob)\n\n  pq = heatmap(x, y, vs.q,\n                 c = :balance,\n              clim = (-2, 2),\n       aspectratio = 1,\n             xlims = (-gr.Lx/2, gr.Lx/2),\n             ylims = (-gr.Ly/2, gr.Ly/2),\n            xticks = -3:3,\n            yticks = -3:3,\n            xlabel = \"x\",\n            ylabel = \"y\",\n             title = \"∇²ψ + η\",\n        framestyle = :box)\n\n  pE = plot(2,\n             label = [\"eddy energy\" \"mean energy\"],\n         linewidth = 2,\n             alpha = 0.7,\n             xlims = (-0.1, 10.1),\n             ylims = (0, 0.0008),\n            xlabel = \"μt\")\n\n  pQ = plot(2,\n             label = [\"eddy enstrophy\" \"mean enstrophy\"],\n         linewidth = 2,\n             alpha = 0.7,\n             xlims = (-0.1, 10.1),\n             ylims = (-0.02, 0.12),\n            xlabel = \"μt\")\n\n  l = @layout [ a{0.5w} grid(2, 1) ]\n  p = plot(pq, pE, pQ, layout=l, size = (900, 600))\n\n  return p\nend\nnothing # hide","category":"page"},{"location":"generated/barotropicqg_acc/#Time-stepping-the-Problem-forward-1","page":"Barotropic QG beta-plane turbulence over topography","title":"Time-stepping the Problem forward","text":"","category":"section"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"We time-step the Problem forward in time.","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"p = plot_output(prob)\n\nstartwalltime = time()\n\nanim = @animate for j=0:Int(nsteps/nsubs)\n\n  cfl = cl.dt*maximum([maximum(vs.U.+vs.u)/gr.dx, maximum(vs.v)/gr.dy])\n\n  log = @sprintf(\"step: %04d, t: %d, cfl: %.2f, E: %.4f, Q: %.4f, walltime: %.2f min\",\n    cl.step, cl.t, cfl, E.data[E.i], Q.data[Q.i], (time()-startwalltime)/60)\n\n  if j%(2000/nsubs)==0; println(log) end\n\n  p[1][1][:z] = Array(vs.q)\n  p[1][:title] = \"∇²ψ + η, μt=\"*@sprintf(\"%.2f\", μ*cl.t)\n  push!(p[2][1], μ*E.t[E.i], E.data[E.i])\n  push!(p[2][2], μ*Emean.t[Emean.i], Emean.data[Emean.i])\n  push!(p[3][1], μ*Q.t[Q.i], Q.data[Q.i])\n  push!(p[3][2], μ*Qmean.t[Qmean.i], Qmean.data[Qmean.i])\n\n  stepforward!(prob, diags, nsubs)\n  BarotropicQG.updatevars!(prob)\n\nend\n\nmp4(anim, \"barotropicqg_acc.mp4\", fps=18)","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"Note that since mean flow enstrophy is Q_U = beta U it can attain negative values.","category":"page"},{"location":"generated/barotropicqg_acc/#Save-1","page":"Barotropic QG beta-plane turbulence over topography","title":"Save","text":"","category":"section"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"Finally save the last snapshot.","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"savename = @sprintf(\"%s_%09d.png\", joinpath(plotpath, plotname), cl.step)\nsavefig(savename)","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"","category":"page"},{"location":"generated/barotropicqg_acc/#","page":"Barotropic QG beta-plane turbulence over topography","title":"Barotropic QG beta-plane turbulence over topography","text":"This page was generated using Literate.jl.","category":"page"},{"location":"man/types/#Private-types-1","page":"Private types","title":"Private types","text":"","category":"section"},{"location":"man/types/#Private-types-in-module-GeophysicalFlows:-1","page":"Private types","title":"Private types in module GeophysicalFlows:","text":"","category":"section"},{"location":"man/types/#","page":"Private types","title":"Private types","text":"Modules = [GeophysicalFlows]\nPublic = false\nOrder = [:type]","category":"page"},{"location":"man/types/#Private-types-in-module-TwoDNavierStokes:-1","page":"Private types","title":"Private types in module TwoDNavierStokes:","text":"","category":"section"},{"location":"man/types/#","page":"Private types","title":"Private types","text":"Modules = [GeophysicalFlows.TwoDNavierStokes]\nPublic = false\nOrder = [:type]","category":"page"},{"location":"man/types/#GeophysicalFlows.TwoDNavierStokes.ForcedVars-Union{Tuple{T}, Tuple{Dev}, Tuple{Dev,AbstractGrid{T,Ta} where Ta}} where T where Dev","page":"Private types","title":"GeophysicalFlows.TwoDNavierStokes.ForcedVars","text":"ForcedVars(dev, g)\n\nReturns the vars for forced two-dimensional turbulence on device dev and with  grid g.\n\n\n\n\n\n","category":"method"},{"location":"man/types/#GeophysicalFlows.TwoDNavierStokes.Params","page":"Private types","title":"GeophysicalFlows.TwoDNavierStokes.Params","text":"Params(ν, nν, μ, nμ, calcF!)\n\nReturns the params for two-dimensional turbulence.\n\n\n\n\n\n","category":"type"},{"location":"man/types/#GeophysicalFlows.TwoDNavierStokes.StochasticForcedVars-Union{Tuple{T}, Tuple{Dev}, Tuple{Dev,AbstractGrid{T,Ta} where Ta}} where T where Dev","page":"Private types","title":"GeophysicalFlows.TwoDNavierStokes.StochasticForcedVars","text":"StochasticForcedVars(dev, g)\n\nReturns the vars for stochastically forced two-dimensional turbulence on device dev and with grid g.\n\n\n\n\n\n","category":"method"},{"location":"man/types/#GeophysicalFlows.TwoDNavierStokes.Vars-Union{Tuple{T}, Tuple{Dev}, Tuple{Dev,AbstractGrid{T,Ta} where Ta}} where T where Dev","page":"Private types","title":"GeophysicalFlows.TwoDNavierStokes.Vars","text":"Vars(dev, g)\n\nReturns the vars for unforced two-dimensional turbulence on device dev and with  grid g.\n\n\n\n\n\n","category":"method"},{"location":"man/types/#Private-types-in-module-BarotropicQG:-1","page":"Private types","title":"Private types in module BarotropicQG:","text":"","category":"section"},{"location":"man/types/#","page":"Private types","title":"Private types","text":"Modules = [GeophysicalFlows.BarotropicQG]\nPublic = false\nOrder = [:type]","category":"page"},{"location":"man/types/#GeophysicalFlows.BarotropicQG.ForcedVars-Union{Tuple{T}, Tuple{Dev}, Tuple{Dev,AbstractGrid{T,Ta} where Ta}} where T where Dev","page":"Private types","title":"GeophysicalFlows.BarotropicQG.ForcedVars","text":"ForcedVars(dev, g)\n\nReturns the vars for forced two-dimensional barotropic QG problem on device dev and with grid g.\n\n\n\n\n\n","category":"method"},{"location":"man/types/#GeophysicalFlows.BarotropicQG.Params","page":"Private types","title":"GeophysicalFlows.BarotropicQG.Params","text":"Params(g::TwoDGrid, f0, β, FU, eta, μ, ν, nν, calcFU, calcFq)\n\nReturns the params for an unforced two-dimensional barotropic QG problem.\n\n\n\n\n\n","category":"type"},{"location":"man/types/#GeophysicalFlows.BarotropicQG.Params-Union{Tuple{A}, Tuple{T}, Tuple{AbstractGrid{T,A},Any,Any,Function,Any,Any,Int64,Any,Any}} where A where T","page":"Private types","title":"GeophysicalFlows.BarotropicQG.Params","text":"Params(g::TwoDGrid, f0, β, eta::Function, μ, ν, nν, calcFU, calcFq)\n\nConstructor for Params that accepts a generating function for the topographic PV.\n\n\n\n\n\n","category":"method"},{"location":"man/types/#GeophysicalFlows.BarotropicQG.StochasticForcedVars-Union{Tuple{T}, Tuple{Dev}, Tuple{Dev,AbstractGrid{T,Ta} where Ta}} where T where Dev","page":"Private types","title":"GeophysicalFlows.BarotropicQG.StochasticForcedVars","text":"StochasticForcedVars(dev, g)\n\nReturns the vars for stochastically forced two-dimensional barotropic QG problem on device dev and with grid g.\n\n\n\n\n\n","category":"method"},{"location":"man/types/#GeophysicalFlows.BarotropicQG.Vars-Union{Tuple{T}, Tuple{Dev}, Tuple{Dev,AbstractGrid{T,Ta} where Ta}} where T where Dev","page":"Private types","title":"GeophysicalFlows.BarotropicQG.Vars","text":"Vars(dev, g)\n\nReturns the vars for unforced two-dimensional barotropic QG problem on device dev and with grid g.\n\n\n\n\n\n","category":"method"},{"location":"man/types/#Private-types-in-module-BarotropicQGQL:-1","page":"Private types","title":"Private types in module BarotropicQGQL:","text":"","category":"section"},{"location":"man/types/#","page":"Private types","title":"Private types","text":"Modules = [GeophysicalFlows.BarotropicQGQL]\nPublic = false\nOrder = [:type]","category":"page"},{"location":"man/types/#GeophysicalFlows.BarotropicQGQL.ForcedVars","page":"Private types","title":"GeophysicalFlows.BarotropicQGQL.ForcedVars","text":"ForcedVars(g)\n\nReturns the vars for forced two-dimensional barotropic QG problem with grid g.\n\n\n\n\n\n","category":"type"},{"location":"man/types/#GeophysicalFlows.BarotropicQGQL.Params","page":"Private types","title":"GeophysicalFlows.BarotropicQGQL.Params","text":"Params(g::TwoDGrid, f0, beta, FU, eta, mu, nu, nnu)\n\nReturns the params for an unforced two-dimensional barotropic QG problem.\n\n\n\n\n\n","category":"type"},{"location":"man/types/#GeophysicalFlows.BarotropicQGQL.Params-Union{Tuple{T}, Tuple{AbstractGrid{T,Ta} where Ta,Any,Any,Function,Any,Any,Any,Any}} where T","page":"Private types","title":"GeophysicalFlows.BarotropicQGQL.Params","text":"Params(g::TwoDGrid, f0, beta, eta::Function, mu, nu, nnu)\n\nConstructor for Params that accepts a generating function for the topographic PV.\n\n\n\n\n\n","category":"method"},{"location":"man/types/#GeophysicalFlows.BarotropicQGQL.Vars","page":"Private types","title":"GeophysicalFlows.BarotropicQGQL.Vars","text":"Vars(g)\n\nReturns the vars for unforced two-dimensional barotropic QG problem with grid g.\n\n\n\n\n\n","category":"type"},{"location":"man/types/#Private-types-in-module-MultilayerQG:-1","page":"Private types","title":"Private types in module MultilayerQG:","text":"","category":"section"},{"location":"man/types/#","page":"Private types","title":"Private types","text":"Modules = [GeophysicalFlows.MultilayerQG]\nPublic = false\nOrder = [:type]","category":"page"},{"location":"man/types/#GeophysicalFlows.MultilayerQG.ForcedVars-Union{Tuple{T}, Tuple{AbstractGrid{T,Ta} where Ta,Any}} where T","page":"Private types","title":"GeophysicalFlows.MultilayerQG.ForcedVars","text":"ForcedVars(g)\n\nReturns the vars for forced multi-layer QG problem with grid gr.\n\n\n\n\n\n","category":"method"},{"location":"man/types/#GeophysicalFlows.MultilayerQG.Vars-Union{Tuple{T}, Tuple{AbstractGrid{T,Ta} where Ta,Any}} where T","page":"Private types","title":"GeophysicalFlows.MultilayerQG.Vars","text":"Vars(g)\n\nReturns the vars for unforced multi-layer QG problem with grid gr.\n\n\n\n\n\n","category":"method"},{"location":"#GeophysicalFlows.jl-Documentation-1","page":"Home","title":"GeophysicalFlows.jl Documentation","text":"","category":"section"},{"location":"#Overview-1","page":"Home","title":"Overview","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"GeophysicalFlows.jl is a collection of modules which leverage the  FourierFlows.jl framework to provide solvers for problems in Geophysical Fluid Dynamics, on periodic domains and using Fourier-based pseudospectral methods.","category":"page"},{"location":"#Developers-1","page":"Home","title":"Developers","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"GeophysicalFlows is currently being developed by Navid C. Constantinou and Gregory L. Wagner.","category":"page"},{"location":"#Cite-1","page":"Home","title":"Cite","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"The code is citable via zenodo.","category":"page"}]
}
