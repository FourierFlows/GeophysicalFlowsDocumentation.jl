<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Thin-layer Boussinesq modules · GeophysicalFlows.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>GeophysicalFlows.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><span class="toctext">Modules</span><ul><li><a class="toctext" href="twodturb.html">TwoDTurb Module</a></li><li><a class="toctext" href="barotropicqg.html">BarotropicQG Module</a></li><li class="current"><a class="toctext" href="boussinesq.html">Thin-layer Boussinesq modules</a><ul class="internal"><li><a class="toctext" href="#Vertically-Fourier-Boussinesq-1">Vertically Fourier Boussinesq</a></li><li><a class="toctext" href="#Vertically-Cosine-Boussinesq-1">Vertically Cosine Boussinesq</a></li></ul></li></ul></li><li><span class="toctext">DocStrings</span><ul><li><a class="toctext" href="../man/types.html">Private types</a></li><li><a class="toctext" href="../man/functions.html">Functions</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Modules</li><li><a href="boussinesq.html">Thin-layer Boussinesq modules</a></li></ul><a class="edit-page" href="https://github.com/FourierFlows/GeophysicalFlows.jl/blob/master/docs/src/modules/boussinesq.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Thin-layer Boussinesq modules</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Thin-layer-Boussinesq-modules-1" href="#Thin-layer-Boussinesq-modules-1">Thin-layer Boussinesq modules</a></h1><div>\[\newcommand{\bcdot}{\boldsymbol \cdot}
\newcommand{\bnabla}{\boldsymbol \nabla}
\newcommand{\pnabla}{\bnabla_{\! \perp}}

\newcommand{\com}{\, ,}
\newcommand{\per}{\, .}

\newcommand{\bu}{\boldsymbol u}
\newcommand{\bU}{\boldsymbol U}
\newcommand{\buu}{{\boldsymbol{u}}}
\newcommand{\bb}{{b}}
\newcommand{\pp}{{p}}
\newcommand{\ww}{{w}}
\newcommand{\uu}{{u}}
\newcommand{\v}{\upsilon}
\newcommand{\vv}{{\upsilon}}
\newcommand{\zzeta}{{\zeta}}
\newcommand{\oomega}{{\omega}}
\newcommand{\boomega}{\boldsymbol{\oomega}}

\newcommand{\bxh}{\widehat{\boldsymbol{x}}}
\newcommand{\byh}{\widehat{\boldsymbol{y}}}
\newcommand{\bzh}{\widehat{\boldsymbol{z}}}
\newcommand{\ii}{\mathrm{i}}
\newcommand{\ee}{\mathrm{e}}
\newcommand{\cc}{\mathrm{c.c.}}
\newcommand{\J}{\mathsf{J}}

\newcommand{\p}{\partial}\]</div><p>These modules solve various thin-layer approximations to the hydrostatic Boussinesq equations. A thin-layer approximation is one that is appropriate for dynamics with small aspect ratios, or small vertical scales and large horizontal scales. Thin layer approximations include the shallow-water system, layered system, and spectral approximations that apply a Fourier or Sin/Cos eigenfunction expansion in the vertical coordinate to the Boussinesq equations, and truncate the expansion at just two or three modes. Approximations of this last flavor are described here.</p><p>The three-dimensional rotating, stratified, hydrostatic Boussinesq equations are</p><div>\[\p_t\buu + \left ( \buu \bcdot \bnabla \right ) \buu + f \bzh \times \buu + \bnabla \pp = D^{\buu} \com \\
\p_z \pp = \bb \com \\
\p_t\bb + \ww N^2 = D^\bb \com \\
\bnabla \bcdot \buu = 0 \com\]</div><p>where <span>$\bu = (u, \v, w)$</span> is the three-dimensional velocity, <span>$b$</span> is buoyancy, <span>$p$</span> is pressure, <span>$N^2$</span> is the buoyancy frequency (constant), and <span>$f$</span> is the rotation or Coriolis frequency. The operators <span>$D^{\buu}$</span> and <span>$D^{\bb}$</span> are arbitrary dissipation that we define only after projecting onto vertical Fourier or Sin/Cos modes. Taking the curl of the horizontal momentum equation yields an evolution equation for vertical vorticity, <span>$\zzeta = \p_x \vv - \p_y \uu$</span>:</p><div>\[\p_t\zzeta + \buu \bcdot \bnabla \zzeta - \left (f \bzh + \boomega \right )
    \bcdot \bnabla \ww = D^{\zzeta} \per\]</div><h2><a class="nav-anchor" id="Vertically-Fourier-Boussinesq-1" href="#Vertically-Fourier-Boussinesq-1">Vertically Fourier Boussinesq</a></h2><p>The vertically-Fourier Boussinesq module solves the Boussinesq system obtained by expanding the hydrostatic Boussinesq equations in a Fourier series. The horizontal velocity <span>$\uu$</span>, for example, is expanded with</p><div>\[\uu(x, y, z, t) \mapsto U(x, y, t) + \ee^{\ii m z} u(x, y, t) + \ee^{-\ii m z} u^*(x, y, t) \com\]</div><p>The other variables <span>$\vv$</span>, <span>$\bb$</span>, <span>$\pp$</span>, <span>$\zzeta$</span>, and <span>$\boomega$</span> are expanded identically. The barotropic horizontal velocity is <span>$V$</span> and the barotropic vertical vorticity is <span>$Z = \p_x V - \p_y U$</span>. The barotropic vorticity obeys</p><div>\[\p_t Z + \J \left ( \Psi, Z \right )
    + \bnabla \bcdot \left ( \bu \zeta^* \right ) + \ii m \pnabla \bcdot \left ( \bu w^* \right ) + \cc
    = D_0 Z \com\]</div><p>where <span>$\cc$</span> denotes the complex conjugate and contraction with <span>$\pnabla = -\p_y \bxh + \p_x \byh$</span> gives the vertical component of the curl.</p><p>The baroclinic components obey</p><div>\[\p_t u - f \v + \p_x p = - \J \left ( \Psi, u \right ) - \bu \bcdot \bnabla U + D_1 u \com \\
\p_t \v + f u + \p_y p = - \J \left ( \Psi, \v \right ) - \bu \bcdot \bnabla V + D_1 \v \com \\
\p_t p - \tfrac{N^2}{m} w = - \J \left ( \Psi, p \right ) + D_1 p \per\]</div><p>The dissipation operators are defined</p><div>\[D_0 = \nu_0 (-1)^{n_0} \nabla^{2n_0} + \mu_0 (-1)^{m_0} \nabla^{2m_0} \com \\
D_1 = \nu_1 (-1)^{n_1} \nabla^{2n_1} + \mu_1 (-1)^{m_1} \nabla^{2m_1}\]</div><p>where <span>$U$</span> is the barotropic velocity and <span>$u$</span> is the amplitude of the first baroclinic mode with periodic vertical structure <span>$\mathrm{e}^{\mathrm{i} m z}$</span>.</p><h3><a class="nav-anchor" id="Implementation-1" href="#Implementation-1">Implementation</a></h3><p>Coming soon.</p><h2><a class="nav-anchor" id="Vertically-Cosine-Boussinesq-1" href="#Vertically-Cosine-Boussinesq-1">Vertically Cosine Boussinesq</a></h2><p>The vertically-Cosine Boussinesq module solves the Boussinesq system obtained by expanding the hydrostatic Boussinesq equations in a Sin/Cos series. The horizontal velocity, for example, becomes</p><div>\[\uu(x, y, z, t) \mapsto U(x, y, t) + \cos(mz) u(x, y, t) \per\]</div><p>The horizontal velocity <span>$\vv$</span>, pressure <span>$\pp$</span>, and vertical vorticity <span>$\zzeta$</span> are also expanded in <span>$\cos(mz)$</span>, where <span>$Z = \p_x V - \p_y U$</span> denotes the barotropic component of the vertical vorticity. The vertical velocity <span>$\ww$</span> and buoyancy <span>$\bb$</span> are expanded with <span>$\sin(mz)$</span>.</p><h3><a class="nav-anchor" id="Basic-governing-equations-1" href="#Basic-governing-equations-1">Basic governing equations</a></h3><p>Projecting the vertical vorticity equation onto Sin/Cos modes an equation for the evolution of <span>$Z$</span>,</p><div>\[\p_t Z + \J \left ( \Psi, Z \right )
    + \tfrac{1}{2} \bnabla \bcdot \left ( \bu \zeta \right ) + \tfrac{m}{2} \pnabla \bcdot \left ( \bu w \right )
    = D_0 Z \com\]</div><p>where <span>$\J(a, b) = (\p_x a)(\p_y b) - (\p_y a)(\p_x b)$</span> is the Jacobian operator, contraction with <span>$\pnabla = -\p_y \bxh + \p_x \byh$</span> gives the vertical component of the curl, and <span>$\Psi$</span> is the barotropic streamfunction defined so that</p><div>\[\bU = -\p_y\Psi \bxh + \p_x\Psi \byh \qquad \text{and} \qquad Z = \nabla^2 \Psi \per\]</div><p>The baroclinic components obey</p><div>\[\p_t u - f \v + \p_x p = - \J \left ( \Psi, u \right ) - \bu \bcdot \bnabla U + D_1u \com \\
\p_t \v + f u + \p_y p = - \J \left ( \Psi, \v \right ) - \bu \bcdot \bnabla V + D_1\v \com \\
\p_t p - \tfrac{N^2}{m} w = - \J \left ( \Psi, p \right ) + D_1p \per\]</div><p>The dissipation operators are defined</p><div>\[D_0 = \nu_0 (-1)^{n_0} \nabla^{2n_0} + \mu_0 (-1)^{m_0} \nabla^{2m_0} \com \\
D_1 = \nu_1 (-1)^{n_1} \nabla^{2n_1} + \mu_1 (-1)^{m_1} \nabla^{2m_1} \com\]</div><p>where <span>$2n_0$</span> and <span>$2m_0$</span> are the hyperviscous orders of the arbitrary barotropic dissipation operators with coefficients <span>$\nu_0$</span> and <span>$\mu_0$</span>, while <span>$2n_1$</span> and <span>$2m_1$</span> are the orders of the baroclinic dissipation operators.</p><p>A passive tracer in the Vertically Cosine Boussinesq system is assumed to satisfy a no-flux condition at the upper and lower boundaries, and thus expanded in cosine modes so that</p><div>\[c(x, y, z, t) = C(x, y, t) + \cos(mz) c(x, y, t) \per\]</div><p>The barotropic and baroclinic passive tracer components then obey</p><div>\[\p_t C + \J(\Psi, C) + \tfrac{1}{2} \bnabla \bcdot \left ( \bu c \right ) =
    \kappa (-1)^{n_{\kappa}} \nabla^{2{n_{\kappa}}} C \com \\
\p_t c + \J(\Psi, c) + \bu \bcdot \bnabla C = \kappa (-1)^{n_{\kappa}} \nabla^{2{n_{\kappa}}} c \com\]</div><p>where <span>$\kappa$</span> and <span>$n_{\kappa}$</span> are the tracer hyperdiffusivity and order of the hyperdiffusivity, respectively. The choice <span>$n_{\kappa} = 1$</span> corresponds to ordinary Fickian diffusivity.</p><h3><a class="nav-anchor" id="Implementation-2" href="#Implementation-2">Implementation</a></h3><p>Coming soon.</p><footer><hr/><a class="previous" href="barotropicqg.html"><span class="direction">Previous</span><span class="title">BarotropicQG Module</span></a><a class="next" href="../man/types.html"><span class="direction">Next</span><span class="title">Private types</span></a></footer></article></body></html>
